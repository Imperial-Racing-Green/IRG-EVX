var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.inherits=function(a,c){function b(){}b.prototype=c.prototype;a.superClass_=c.prototype;a.prototype=new b;a.prototype.constructor=a;for(var d in c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(a,d,e)}else a[d]=c[d]};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(b){$jscomp.owns(b,d)||$jscomp.defineProperty(b,d,{value:{}})}function b(b){var a=Object[b];a&&(Object[b]=function(b){c(b);return a(b)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(l){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);b("freeze");b("preventExtensions");
b("seal");var e=0,f=function(b){this.id_=(e+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};f.prototype.set=function(b,a){c(b);if(!$jscomp.owns(b,d))throw Error("WeakMap key fail: "+b);b[d][this.id_]=a;return this};f.prototype.get=function(b){return $jscomp.owns(b,d)?b[d][this.id_]:void 0};f.prototype.has=function(b){return $jscomp.owns(b,d)&&$jscomp.owns(b[d],this.id_)};f.prototype.delete=
function(b){return $jscomp.owns(b,d)&&$jscomp.owns(b[d],this.id_)?delete b[d][this.id_]:!1};return f},"es6-impl","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(m){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var c=new WeakMap,b=function(b){this.data_={};this.head_=f();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};b.prototype.set=function(b,c){var a=d(this,b);a.list||(a.list=this.data_[a.id]=[]);a.entry?a.entry.value=c:(a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,value:c},a.list.push(a.entry),this.head_.previous.next=a.entry,this.head_.previous=a.entry,this.size++);return this};b.prototype.delete=
function(b){b=d(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};b.prototype.has=function(b){return!!d(this,b).entry};b.prototype.get=function(b){return(b=d(this,b).entry)&&b.value};b.prototype.entries=function(){return e(this,function(b){return[b.key,
b.value]})};b.prototype.keys=function(){return e(this,function(b){return b.key})};b.prototype.values=function(){return e(this,function(b){return b.value})};b.prototype.forEach=function(b,c){for(var a=this.entries(),d;!(d=a.next()).done;)d=d.value,b.call(c,d[1],d[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var d=function(b,a){var d=a&&typeof a;"object"==d||"function"==d?c.has(a)?d=c.get(a):(d=""+ ++g,c.set(a,d)):d="p_"+a;var e=b.data_[d];if(e&&$jscomp.owns(b.data_,d))for(b=0;b<e.length;b++){var f=
e[b];if(a!==a&&f.key!==f.key||a===f.key)return{id:d,list:e,index:b,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},e=function(b,c){var a=b.head_;return $jscomp.iteratorPrototype(function(){if(a){for(;a.head!=b.head_;)a=a.previous;for(;a.next!=a.head;)return a=a.next,{done:!1,value:c(a)};a=null}return{done:!0,value:void 0}})},f=function(){var b={};return b.previous=b.next=b.head=b},g=0;return b},"es6-impl","es3");
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(c,b){var a=$jscomp.checkStringArgs(this,c,"startsWith");c+="";var e=a.length,f=c.length;b=Math.max(0,Math.min(b|0,a.length));for(var g=0;g<f&&b<e;)if(a[b++]!=c[g++])return!1;return g>=f}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(c,b,a){var d=this.length||0;0>b&&(b=Math.max(0,d+b));if(null==a||a>d)a=d;a=Number(a);0>a&&(a=Math.max(0,d+a));for(b=Number(b||0);b<a;b++)this[b]=c;return this}},"es6-impl","es3");$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(c,b){return $jscomp.findInternal(this,c,b).i}},"es6-impl","es3");$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(c,b){var a=$jscomp.checkStringArgs(this,c,"endsWith");c+="";void 0===b&&(b=a.length);b=Math.max(0,Math.min(b|0,a.length));for(var e=c.length;0<e&&0<b;)if(a[--b]!=c[--e])return!1;return 0>=e}},"es6-impl","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function c(){this.batch_=null}function b(b){return b instanceof e?b:new e(function(c,a){c(b)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;c.prototype.asyncExecute=function(b){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(b);return this};c.prototype.asyncExecuteBatch_=function(){var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})};var d=$jscomp.global.setTimeout;c.prototype.asyncExecuteFunction=function(b){d(b,
0)};c.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=this.batch_;this.batch_=[];for(var c=0;c<b.length;++c){var a=b[c];delete b[c];try{a()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};c.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var e=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var c=this.createResolveAndReject_();try{b(c.resolve,c.reject)}catch(k){c.reject(k)}};e.prototype.createResolveAndReject_=
function(){function b(b){return function(d){a||(a=!0,b.call(c,d))}}var c=this,a=!1;return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};e.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof e)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var c=null!=b;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};e.prototype.resolveToNonPromiseObj_=function(b){var c=
void 0;try{c=b.then}catch(k){this.reject_(k);return}"function"==typeof c?this.settleSameAsThenable_(c,b):this.fulfill_(b)};e.prototype.reject_=function(b){this.settle_(2,b)};e.prototype.fulfill_=function(b){this.settle_(1,b)};e.prototype.settle_=function(b,c){if(0!=this.state_)throw Error("Cannot settle("+b+", "+c|"): Promise already settled in state"+this.state_);this.state_=b;this.result_=c;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=
this.onSettledCallbacks_,c=0;c<b.length;++c)b[c].call(),b[c]=null;this.onSettledCallbacks_=null}};var f=new c;e.prototype.settleSameAsPromise_=function(b){var c=this.createResolveAndReject_();b.callWhenSettled_(c.resolve,c.reject)};e.prototype.settleSameAsThenable_=function(b,c){var a=this.createResolveAndReject_();try{b.call(c,a.resolve,a.reject)}catch(l){a.reject(l)}};e.prototype.then=function(b,c){function a(b,c){return"function"==typeof b?function(c){try{d(b(c))}catch(u){f(u)}}:c}var d,f,g=new e(function(b,
c){d=b;f=c});this.callWhenSettled_(a(b,d),a(c,f));return g};e.prototype.catch=function(b){return this.then(void 0,b)};e.prototype.callWhenSettled_=function(b,c){function a(){switch(d.state_){case 1:b(d.result_);break;case 2:c(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(a):this.onSettledCallbacks_.push(function(){f.asyncExecute(a)})};e.resolve=b;e.reject=function(b){return new e(function(c,a){a(b)})};e.race=function(c){return new e(function(a,
d){for(var e=$jscomp.makeIterator(c),f=e.next();!f.done;f=e.next())b(f.value).callWhenSettled_(a,d)})};e.all=function(c){var a=$jscomp.makeIterator(c),d=a.next();return d.done?b([]):new e(function(c,e){function f(b){return function(a){g[b]=a;h--;0==h&&c(g)}}var g=[],h=0;do g.push(void 0),h++,b(d.value).callWhenSettled_(f(g.length-1),e),d=a.next();while(!d.done)})};return e},"es6-impl","es3");var wpd=wpd||{};
wpd.initApp=function(){wpd.browserInfo.checkBrowser();wpd.layoutManager.initialLayout();wpd.imageManager.loadFromURL("start.png");wpd.log();document.getElementById("loadingCurtain").style.display="none"};document.addEventListener("DOMContentLoaded",wpd.initApp,!0);wpd=wpd||{};
wpd.AutoDetector=function(){return function(){this.fgColor=[0,0,200];this.bgColor=[255,255,255];this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};this.gridLineColor=[255,255,255];this.gridColorDistance=10;this.gridData=null;this.colorDetectionMode="fg";this.colorDistance=120;this.imageData=this.gridBinaryData=this.binaryData=this.algorithm=null;this.imageHeight=this.imageWidth=0;this.gridBackgroundMode=!0;this.backupImageData=this.topColors=null;this.reset=function(){this.gridData=
this.imageData=this.binaryData=this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]}};this.generateBinaryDataFromMask=function(){var a,c="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(a=0;a<this.mask.length;a++){var b=this.mask[a];var d=this.imageData.data[4*b];var e=this.imageData.data[4*b+1];var f=this.imageData.data[4*b+2];var g=this.imageData.data[4*b+3];0===g&&(f=e=d=255);d=wpd.dist3d(d,e,f,c[0],c[1],c[2]);"fg"===this.colorDetectionMode?d<=this.colorDistance&&
(this.binaryData[b]=!0):d>=this.colorDistance&&(this.binaryData[b]=!0)}};this.generateBinaryDataUsingFullImage=function(){var a,c="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(a=0;a<this.imageData.data.length/4;a++){var b=this.imageData.data[4*a];var d=this.imageData.data[4*a+1];var e=this.imageData.data[4*a+2];var f=this.imageData.data[4*a+3];0===f&&(e=d=b=255);b=wpd.dist3d(b,d,e,c[0],c[1],c[2]);"fg"===this.colorDetectionMode?b<=this.colorDistance&&(this.binaryData[a]=!0):b>=this.colorDistance&&
(this.binaryData[a]=!0)}};this.generateBinaryData=function(){this.binaryData=[];null==this.imageData?this.imageWidth=this.imageHeight=0:(this.imageHeight=this.imageData.height,this.imageWidth=this.imageData.width,null==this.mask||0===this.mask.length?this.generateBinaryDataUsingFullImage():this.generateBinaryDataFromMask())};this.generateGridBinaryData=function(){this.gridBinaryData=[];if(null==this.imageData)this.imageHeight=this.imageWidth=0;else{this.imageWidth=this.imageData.width;this.imageHeight=
this.imageData.height;var a,c;if(null==this.gridMask.pixels||0===this.gridMask.pixels.length){var b=0;this.gridMask.pixels=[];for(c=0;c<this.imageHeight;c++)for(a=0;a<this.imageWidth;a++){var d=c*this.imageWidth+a;var e=this.imageData.data[4*d];var f=this.imageData.data[4*d+1];var g=this.imageData.data[4*d+2];var h=this.imageData.data[4*d+3];0===h&&(g=f=e=255);e=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],e,f,g);this.gridBackgroundMode?e>this.gridColorDistance&&(this.gridBinaryData[d]=
!0,this.gridMask.pixels[b]=d,b++):e<this.gridColorDistance&&(this.gridBinaryData[d]=!0,this.gridMask.pixels[b]=d,b++)}this.gridMask.xmin=0;this.gridMask.xmax=this.imageWidth;this.gridMask.ymin=0;this.gridMask.ymax=this.imageHeight}else for(b=0;b<this.gridMask.pixels.length;b++)d=this.gridMask.pixels[b],e=this.imageData.data[4*d],f=this.imageData.data[4*d+1],g=this.imageData.data[4*d+2],e=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],e,f,g),this.gridBackgroundMode?e>
this.gridColorDistance&&(this.gridBinaryData[d]=!0):e<this.gridColorDistance&&(this.gridBinaryData[d]=!0)}}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(a){var c=[],b=[],d=null==a?2:a,e=[],f=[];this.labels=[];this.labelPositions=[];this.maxPointCount=0;this.getCount=function(){return c.length};this.getDimensions=function(){return d};this.addPoint=function(a,f,k,l,n){var g=c.length,h=e.length;c[g]=a;b[g]=f;e[h]=k;e[h+1]=l;3===d&&(e[h+2]=n)};this.getPoint=function(a){return 0>a||a>=c.length?null:{px:c[a],py:b[a],dx:e[d*a],dy:e[d*a+1],dz:2===d?null:e[d*a+2]}};this.changePointPx=function(a,d,e){0>a||a>=c.length||
(c[a]=d,b[a]=e)};this.setDataAt=function(b,a,f,l){0>b||b>=c.length||(e[d*b]=a,e[d*b+1]=f,3===d&&(e[d*b+2]=l))};this.findNearestPoint=function(a,d,e){e=null==e?50:parseFloat(e);var f=-1,g;for(g=0;g<c.length;g++){var h=Math.sqrt((a-c[g])*(a-c[g])+(d-b[g])*(d-b[g]));if(0>f&&h<=e||0<=f&&h<k){f=g;var k=h}}return f};this.selectPoint=function(b){0>f.indexOf(b)&&(f[f.length]=b)};this.selectNearestPoint=function(b,c,a){b=this.findNearestPoint(b,c,a);0<=b&&this.selectPoint(b)};this.getSelectedPoints=function(){return f};
this.unselectAll=function(){f=[]};this.isPointSelected=function(b){return 0<=f.indexOf(b)};this.dump=function(){console.log(c);console.log(b);console.log(e)}}}();wpd=wpd||{};
wpd.ColorGroup=function(){return function(a){var c=0,b={r:0,g:0,b:0};a=null==a?100:a;this.getPixelCount=function(){return c};this.getAverageColor=function(){return b};this.isColorInGroup=function(d,e,f){return 0===c?!0:(b.r-d)*(b.r-d)+(b.g-e)*(b.g-e)+(b.b-f)*(b.b-f)<=a*a};this.addPixel=function(a,e,f){b.r=(b.r*c+a)/(c+1);b.g=(b.g*c+e)/(c+1);b.b=(b.b*c+f)/(c+1);c+=1}}}();
wpd.colorAnalyzer=function(){return{getTopColors:function(a){var c=[],b,d=[];c[0]=new wpd.ColorGroup(120);for(b=0;b<a.data.length;b+=4){var e=a.data[b];var f=a.data[b+1];var g=a.data[b+2];var h=a.data[b+3];0===h&&(g=f=e=255);var k=!1;for(h=0;h<c.length;h++)if(c[h].isColorInGroup(e,f,g)){c[h].addPixel(e,f,g);k=!0;break}k||(c[c.length]=new wpd.ColorGroup(120),c[c.length-1].addPixel(e,f,g))}c.sort(function(b,c){return b.getPixelCount()>c.getPixelCount()?-1:b.getPixelCount()<c.getPixelCount()?1:0});for(h=
0;h<c.length;h++)b=c[h].getAverageColor(),d[h]={r:parseInt(b.r,10),g:parseInt(b.g,10),b:parseInt(b.b,10),pixels:c[h].getPixelCount(),percentage:100*c[h].getPixelCount()/(.25*a.data.length)};return d}}}();wpd=wpd||{};wpd.ConnectedPoints=function(a){this._connections=[];this._selectedPointIndex=this._selectedConnectionIndex=-1;this._connectivity=a};wpd.ConnectedPoints.prototype.addConnection=function(a){this._connections.push(a)};wpd.ConnectedPoints.prototype.clearAll=function(){this._connections=[]};
wpd.ConnectedPoints.prototype.getConnectionAt=function(a){if(a<this._connections.length)return this._connections[a]};wpd.ConnectedPoints.prototype.replaceConnectionAt=function(a,c){a<this._connections.length&&(this._connections[a]=c)};wpd.ConnectedPoints.prototype.deleteConnectionAt=function(a){a<this._connections.length&&this._connections.splice(a,1)};wpd.ConnectedPoints.prototype.connectionCount=function(){return this._connections.length};
wpd.ConnectedPoints.prototype.findNearestPointAndConnection=function(a,c){var b=-1,d=-1,e,f;for(e=0;e<this._connections.length;e++)for(f=0;f<this._connections[e].length;f+=2){var g=(this._connections[e][f]-a)*(this._connections[e][f]-a)+(this._connections[e][f+1]-c)*(this._connections[e][f+1]-c);if(-1===d||g<h){b=e;d=f/2;var h=g}}return{connectionIndex:b,pointIndex:d}};
wpd.ConnectedPoints.prototype.selectNearestPoint=function(a,c){a=this.findNearestPointAndConnection(a,c);0<=a.connectionIndex&&(this._selectedConnectionIndex=a.connectionIndex,this._selectedPointIndex=a.pointIndex)};wpd.ConnectedPoints.prototype.deleteNearestConnection=function(a,c){a=this.findNearestPointAndConnection(a,c);0<=a.connectionIndex&&this.deleteConnectionAt(a.connectionIndex)};
wpd.ConnectedPoints.prototype.isPointSelected=function(a,c){return this._selectedPointIndex===c&&this._selectedConnectionIndex===a?!0:!1};wpd.ConnectedPoints.prototype.getSelectedConnectionAndPoint=function(){return{connectionIndex:this._selectedConnectionIndex,pointIndex:this._selectedPointIndex}};wpd.ConnectedPoints.prototype.unselectConnectionAndPoint=function(){this._selectedPointIndex=this._selectedConnectionIndex=-1};
wpd.ConnectedPoints.prototype.setPointAt=function(a,c,b,d){this._connections[a][2*c]=b;this._connections[a][2*c+1]=d};wpd.ConnectedPoints.prototype.getPointAt=function(a,c){return{x:this._connections[a][2*c],y:this._connections[a][2*c+1]}};wpd.DistanceMeasurement=function(){wpd.ConnectedPoints.call(this,2)};$jscomp.inherits(wpd.DistanceMeasurement,wpd.ConnectedPoints);
wpd.DistanceMeasurement.prototype.getDistance=function(a){if(a<this._connections.length&&2===this._connectivity)return Math.sqrt((this._connections[a][0]-this._connections[a][2])*(this._connections[a][0]-this._connections[a][2])+(this._connections[a][1]-this._connections[a][3])*(this._connections[a][1]-this._connections[a][3]))};wpd.AngleMeasurement=function(){wpd.ConnectedPoints.call(this,3)};$jscomp.inherits(wpd.AngleMeasurement,wpd.ConnectedPoints);
wpd.AngleMeasurement.prototype.getAngle=function(a){if(a<this._connections.length&&3===this._connectivity){var c=wpd.taninverse(-(this._connections[a][5]-this._connections[a][3]),this._connections[a][4]-this._connections[a][2]);a=wpd.taninverse(-(this._connections[a][1]-this._connections[a][3]),this._connections[a][0]-this._connections[a][2]);c=180*(c-a)/Math.PI;return 0>c?c+360:c}};wpd.AreaMeasurement=function(){wpd.ConnectedPoints.call(this,-1)};$jscomp.inherits(wpd.AreaMeasurement,wpd.ConnectedPoints);
wpd.AreaMeasurement.prototype.getArea=function(a){if(a<this._connections.length&&4<=this._connections[a].length){for(var c=0,b=0;b<this._connections[a].length;b+=2){var d=this._connections[a][b],e=this._connections[a][b+1];if(b<=this._connections[a].length-4){var f=this._connections[a][b+2];var g=this._connections[a][b+3]}else f=this._connections[a][0],g=this._connections[a][1];c+=d*g-f*e}return c/2}return 0};
wpd.AreaMeasurement.prototype.getPerimeter=function(a){if(a<this._connections.length){for(var c=0,b=0,d=0,e=0;e<this._connections[a].length;e+=2){var f=this._connections[a][e],g=this._connections[a][e+1];2<=e&&(c+=Math.sqrt((f-b)*(f-b)+(g-d)*(g-d)));e==this._connections[a].length-2&&4<=e&&(b=this._connections[a][0],d=this._connections[a][1],c+=Math.sqrt((f-b)*(f-b)+(g-d)*(g-d)));b=f;d=g}return c}};wpd=wpd||{};
wpd.plotDataProvider=function(){var a=null;return{setDataSource:function(c){a=c},getData:function(){var c=wpd.appData.getPlotData().getAxesForDataset(a);if(c instanceof wpd.BarAxes){var b=a,d=[],e;for(e=0;e<b.getCount();e++){var f=b.getPixel(e);var g=c.pixelToData(f.x,f.y);d[e]=[];f=null==f.metadata?"Bar"+e:f.metadata[0];d[e][0]=f;d[e][1]=g[0]}return{fields:["Label","Value"],fieldDateFormat:[],rawData:d,allowConnectivity:!1,connectivityFieldIndices:[],isFieldSortable:[!1,!0]}}var h=a,b=[],d=[];e=
[];g=[];var k,l;f=h.hasMetadata();var n=h.getMetadataKeys(),m=!0===f?n.length:0;for(k=0;k<h.getCount();k++){var p=h.getPixel(k);var q=c.pixelToData(p.x,p.y);e[k]=[];for(l=0;l<q.length;l++)e[k][l]=q[l];for(l=0;l<m;l++){var r=null==p.metadata||null==p.metadata[l]?0:p.metadata[l];e[k][q.length+l]=r}}h=c.getAxesLabels();f&&(h=h.concat(n));for(l=0;l<h.length;l++)l<c.getDimensions()&&(d[l]=l,null!=c.isDate&&c.isDate(l)&&(b[l]=c.getInitialDateFormat(l))),g[l]=!0;return{fields:h,fieldDateFormat:b,rawData:e,
allowConnectivity:!0,connectivityFieldIndices:d,isFieldSortable:g}}}}();
wpd.measurementDataProvider=function(){var a=null;return{getData:function(){var c=[],b=[],d=[],e=wpd.appData.getPlotData().getAxesForMeasurement(a),f=null!=e&&e instanceof wpd.MapAxes;if(a instanceof wpd.DistanceMeasurement){for(c=0;c<a.connectionCount();c++)b[c]=[],b[c][0]="Dist"+c,b[c][1]=f?e.pixelToDataDistance(a.getDistance(c)):a.getDistance(c);c=["Label","Distance"];d=[!1,!0]}else if(a instanceof wpd.AngleMeasurement){for(c=0;c<a.connectionCount();c++)b[c]=[],b[c][0]="Theta"+c,b[c][1]=a.getAngle(c);
c=["Label","Angle"];d=[!1,!0]}else if(a instanceof wpd.AreaMeasurement){for(c=0;c<a.connectionCount();c++)b[c]=[],b[c][0]="Poly"+c,f?(b[c][1]=e.pixelToDataArea(a.getArea(c)),b[c][2]=e.pixelToDataDistance(a.getPerimeter(c))):(b[c][1]=a.getArea(c),b[c][2]=a.getPerimeter(c));c=["Label","Area","Perimeter"];d=[!1,!0,!0]}return{fields:c,fieldDateFormat:[],rawData:b,allowConnectivity:!1,connectivityFieldIndices:[],isFieldSortable:d}},setDataSource:function(c){a=c}}}();wpd=wpd||{};
wpd.Dataset=function(){return function(a){var c=[],b=[],d=!1,e=[];this.name="Default Dataset";this.variableNames=["x","y"];this.hasMetadata=function(){return d};this.setMetadataKeys=function(b){e=b};this.getMetadataKeys=function(){return e};this.addPixel=function(b,a,e){c[c.length]={x:b,y:a,metadata:e};null!=e&&(d=!0)};this.getPixel=function(b){return c[b]};this.setPixelAt=function(b,a,d){b<c.length&&(c[b].x=a,c[b].y=d)};this.setMetadataAt=function(b,a){b<c.length&&(c[b].metadata=a)};this.insertPixel=
function(b,a,d,e){c.splice(b,0,{x:a,y:d,metadata:e})};this.removePixelAtIndex=function(b){b<c.length&&c.splice(b,1)};this.removeLastPixel=function(){this.removePixelAtIndex(c.length-1)};this.findNearestPixel=function(b,a,d){d=null==d?50:parseFloat(d);var e=-1,f;for(f=0;f<c.length;f++){var g=Math.sqrt((b-c[f].x)*(b-c[f].x)+(a-c[f].y)*(a-c[f].y));if(0>e&&g<=d||0<=e&&g<h){e=f;var h=g}}return e};this.removeNearestPixel=function(b,a,c){b=this.findNearestPixel(b,a,c);0<=b&&this.removePixelAtIndex(b)};this.clearAll=
function(){c=[];d=!1;e=[]};this.getCount=function(){return c.length};this.selectPixel=function(a){0<=b.indexOf(a)||(b[b.length]=a)};this.unselectAll=function(){b=[]};this.selectNearestPixel=function(b,a,c){b=this.findNearestPixel(b,a,c);0<=b&&this.selectPixel(b);return b};this.selectNextPixel=function(){for(var a=0;a<b.length;a++)b[a]=(b[a]+1)%c.length};this.selectPreviousPixel=function(){var a;for(a=0;a<b.length;a++){var d=b[a];d=0===d?c.length-1:d-1;b[a]=d}};this.getSelectedPixels=function(){return b}}}();
wpd=wpd||{};
wpd.dateConverter=function(){function a(a){a=a.toString();var b=a.split(/[/ :]/);a=0<=a.indexOf("/");if(0>=b.length||6<b.length)return null;if(a){a=parseInt(b[0],10);var c=parseInt(void 0===b[1]?0:b[1],10);var e=parseInt(void 0===b[2]?1:b[2],10);var f=3}else e=new Date,a=e.getFullYear(),c=e.getMonth()+1,e=e.getDate(),f=0;var g=parseInt(void 0===b[f]?0:b[f],10);var h=parseInt(void 0===b[f+1]?0:b[f+1],10);b=parseInt(void 0===b[f+2]?0:b[f+2],10);if(isNaN(a)||isNaN(c)||isNaN(e)||isNaN(g)||isNaN(h)||isNaN(b)||
12<c||1>c||31<e||1>e||23<g||0>g||59<h||0>h||59<b||0>b)return null;f=new Date;f.setUTCFullYear(a);f.setUTCMonth(c-1);f.setUTCDate(e);f.setUTCHours(g,h,b);b=parseFloat(Date.parse(f));return isNaN(b)?null:b}return{parse:function(c){return null==c||"string"===typeof c&&0>c.indexOf("/")&&0>c.indexOf(":")?null:a(c)},getFormatString:function(a){var b=a.split(/[/ :]/);a=0<=a.indexOf("/");var c="yyyy/mm/dd hh:ii:ss";1<=b.length&&(c=a?"yyyy":"hh");2<=b.length&&(c+=a?"/mm":":ii");3<=b.length&&(c+=a?"/dd":":ss");
4<=b.length&&(c+=" hh");5<=b.length&&(c+=":ii");6===b.length&&(c+=":ss");return c},formatDateNumber:function(a,b){var c=1;0<=b.indexOf("s")?c=1E3:0<=b.indexOf("i")?c=6E4:0<=b.indexOf("h")?c=36E5:0<=b.indexOf("d")?c=864E5:0<=b.indexOf("m")?c=2629746E3:0<=b.indexOf("y")&&(c=31556952E3);a=new Date(Math.round((new Date(a)).getTime()/c)*c);for(var c=[],e=[],f=new Date,g=0;12>g;g++)f.setUTCMonth(g),c.push(f.toLocaleString(void 0,{month:"long"})),e.push(f.toLocaleString(void 0,{month:"short"}));b=b.replace("YYYY",
"yyyy");b=b.replace("YY","yy");b=b.replace("MMMM","mmmm");b=b.replace("MMM","mmm");b=b.replace("MM","mm");b=b.replace("DD","dd");b=b.replace("HH","hh");b=b.replace("II","ii");b=b.replace("SS","ss");b=b.replace("yyyy",a.getUTCFullYear());f=a.getUTCFullYear()%100;b=b.replace("yy",10>f?"0"+f:f);b=b.replace("mmmm",c[a.getUTCMonth()]);b=b.replace("mmm",e[a.getUTCMonth()]);b=b.replace("mm",("0"+(a.getUTCMonth()+1)).slice(-2));b=b.replace("dd",("0"+a.getUTCDate()).slice(-2));b=b.replace("hh",("0"+a.getUTCHours()).slice(-2));
b=b.replace("ii",("0"+a.getUTCMinutes()).slice(-2));return b=b.replace("ss",("0"+a.getUTCSeconds()).slice(-2))}}}();wpd=wpd||{};
wpd.gridDetectionCore=function(){var a,c,b=.1,d=.1;return{run:function(e){var f=[],g,h,k=e.gridMask.xmin,l=e.gridMask.xmax,n=e.gridMask.ymin,m=e.gridMask.ymax,p=e.imageWidth;if(c)for(g=k;g<=l;g++){var q=0;for(h=n;h<m;h++)!0===e.gridBinaryData[h*p+g]&&q++;if(q>d*(m-n))for(h=n;h<m;h++)f[h*p+g]=!0}if(a)for(h=n;h<=m;h++){q=0;for(g=k;g<=l;g++)!0===e.gridBinaryData[h*p+g]&&q++;if(q>b*(l-k))for(g=k;g<=l;g++)f[h*p+g]=!0}return f},setHorizontalParameters:function(b,c){a=b;d=Math.abs(parseFloat(c)/100)},setVerticalParameters:function(a,
d){c=a;b=Math.abs(parseFloat(d)/100)}}}();wpd=wpd||{};wpd.InputParser=function(){return function(){this.parse=function(a){this.isDate=this.isValid=!1;this.formatting=null;if(null==a||"string"===typeof a&&(a=a.trim(),0<=a.indexOf("^")))return null;var c=wpd.dateConverter.parse(a);if(null!=c)return this.isDate=this.isValid=!0,this.formatting=wpd.dateConverter.getFormatString(a),c;a=parseFloat(a);return isNaN(a)?null:(this.isValid=!0,a)};this.isDate=this.isValid=!1;this.formatting=null}}();
wpd=wpd||{};wpd.taninverse=function(a,c){var b;0<a?b=Math.atan2(a,c):0>=a&&(b=Math.atan2(a,c)+2*Math.PI);b>=2*Math.PI&&(b=0);return b};wpd.sqDist2d=function(a,c,b,d){return(a-b)*(a-b)+(c-d)*(c-d)};wpd.sqDist3d=function(a,c,b,d,e,f){return(a-d)*(a-d)+(c-e)*(c-e)+(b-f)*(b-f)};wpd.dist2d=function(a,c,b,d){return Math.sqrt(wpd.sqDist2d(a,c,b,d))};wpd.dist3d=function(a,c,b,d,e,f){return Math.sqrt(wpd.sqDist3d(a,c,b,d,e,f))};
wpd.mat=function(){function a(a){return a[0]*a[3]-a[1]*a[2]}return{det2x2:a,inv2x2:function(c){var b=a(c);return[c[3]/b,-c[1]/b,-c[2]/b,c[0]/b]},mult2x2:function(a,b){return[a[0]*b[0]+a[1]*b[2],a[0]*b[1]+a[1]*b[3],a[2]*b[0]+a[3]*b[2],a[2]*b[1]+a[3]*b[3]]},mult2x2Vec:function(a,b){return[a[0]*b[0]+a[1]*b[1],a[2]*b[0]+a[3]*b[1]]},multVec2x2:function(a,b){return[b[0]*a[0]+b[2]*a[1],b[1]*a[0]+b[3]*a[1]]}}}();
wpd.cspline=function(a,c){var b=a.length;a={x:a,y:c,len:b,d:[]};var d=[],e=[],f;if(3>b)return null;e[0]=2;d[0]=3*(c[1]-c[0]);for(f=1;f<b-1;++f)e[f]=4-1/e[f-1],d[f]=3*(c[f+1]-c[f-1])-d[f-1]/e[f-1];e[b-1]=2-1/e[b-2];d[b-1]=3*(c[b-1]-c[b-2])-d[b-2]/e[b-1];f=b-1;for(a.d[f]=d[f]/e[f];0<f;)--f,a.d[f]=(d[f]-a.d[f+1])/e[f];return a};
wpd.cspline_interp=function(a,c){var b=0;if(c>=a.x[a.len-1]||c<a.x[0])return null;for(;c>a.x[b];)b++;b=0<b?b-1:0;c=(c-a.x[b])/(a.x[b+1]-a.x[b]);return a.y[b]+a.d[b]*c+(3*(a.y[b+1]-a.y[b])-2*a.d[b]-a.d[b+1])*c*c+(2*(a.y[b]-a.y[b+1])+a.d[b]+a.d[b+1])*c*c*c};wpd=wpd||{};wpd.PlotData=function(){this._topColors=this._autoDetector=null;this._axesColl=[];this._datasetColl=[];this._measurementColl=[];this._objectAxesMap=new Map};
wpd.PlotData.prototype.reset=function(){this._axesColl=[];this._datasetColl=[];this._measurementColl=[];this._objectAxesMap=new Map};wpd.PlotData.prototype.addAxes=function(a){this._axesColl.push(a);1===this._axesColl.length&&0===this._datasetColl.length&&(a=new wpd.Dataset,a.name="Default Dataset",this.addDataset(a))};wpd.PlotData.prototype.getAxesColl=function(){return this._axesColl};wpd.PlotData.prototype.getAxesNames=function(){var a=[];this._axesColl.forEach(function(c){a.push(c.name)});return a};
wpd.PlotData.prototype.deleteAxes=function(a){var c=this._axesColl.indexOf(a);0<=c&&(this._axesColl.splice(c,1),this._objectAxesMap.forEach(function(b,c,e){b===a&&e.set(c,null)}))};wpd.PlotData.prototype.getAxesCount=function(){return this._axesColl.length};wpd.PlotData.prototype.addDataset=function(a){this._datasetColl.push(a);var c=this._axesColl.length;0<c&&this.setAxesForDataset(a,this._axesColl[c-1])};wpd.PlotData.prototype.getDatasets=function(){return this._datasetColl};
wpd.PlotData.prototype.getDatasetNames=function(){var a=[];this._datasetColl.forEach(function(c){a.push(c.name)});return a};wpd.PlotData.prototype.getDatasetCount=function(){return this._datasetColl.length};
wpd.PlotData.prototype.addMeasurement=function(a){this._measurementColl.push(a);if(a instanceof wpd.DistanceMeasurement&&0<this._axesColl.length)for(var c=0;c<this._axesColl.length;c++)if(this._axesColl[c]instanceof wpd.MapAxes||this._axesColl[c]instanceof wpd.ImageAxes){this.setAxesForMeasurement(a,this._axesColl[c]);break}};wpd.PlotData.prototype.getMeasurementsByType=function(a){var c=[];this._measurementColl.forEach(function(b){b instanceof a&&c.push(b)});return c};
wpd.PlotData.prototype.deleteMeasurement=function(a){var c=this._measurementColl.indexOf(a);0<=c&&(this._measurementColl.splice(c,1),this._objectAxesMap.delete(a))};wpd.PlotData.prototype.setAxesForDataset=function(a,c){this._objectAxesMap.set(a,c)};wpd.PlotData.prototype.setAxesForMeasurement=function(a,c){this._objectAxesMap.set(a,c)};wpd.PlotData.prototype.getAxesForDataset=function(a){return this._objectAxesMap.get(a)};wpd.PlotData.prototype.getAxesForMeasurement=function(a){return this._objectAxesMap.get(a)};
wpd.PlotData.prototype.deleteDataset=function(a){var c=this._datasetColl.indexOf(a);0<=c&&(this._datasetColl.splice(c,1),this._objectAxesMap.delete(a))};wpd.PlotData.prototype.getAutoDetector=function(){null==this._autoDetector&&(this._autoDetector=new wpd.AutoDetector);return this._autoDetector};
wpd.PlotData.prototype._deserializePreVersion4=function(a){if(null==a.axesType)return!0;if("ImageAxes"!==a.axesType&&(null==a.calibration||null==a.axesParameters))return!1;var c=null;if("ImageAxes"!==a.axesType)for(var c="TernaryAxes"===a.axesType?new wpd.Calibration(3):new wpd.Calibration(2),b=0;b<a.calibration.length;b++)c.addPoint(a.calibration[b].px,a.calibration[b].py,a.calibration[b].dx,a.calibration[b].dy,a.calibration[b].dz);b=null;"XYAxes"===a.axesType?(b=new wpd.XYAxes,c.labels=["X1","X2",
"Y1","Y2"],c.labelPositions=["N","N","E","E"],c.maxPointCount=4,b.calibrate(c,a.axesParameters.isLogX,a.axesParameters.isLogY)):"BarAxes"===a.axesType?(b=new wpd.BarAxes,c.labels=["P1","P2"],c.labelPositions=["S","S"],c.maxPointCount=2,b.calibrate(c,a.axesParameters.isLog)):"PolarAxes"===a.axesType?(b=new wpd.PolarAxes,c.labels=["Origin","P1","P2"],c.labelPositions=["E","S","S"],c.maxPointCount=3,b.calibrate(c,a.axesParameters.isDegrees,a.axesParameters.isClockwise)):"TernaryAxes"===a.axesType?(b=
new wpd.TernaryAxes,c.labels=["A","B","C"],c.labelPositions=["S","S","E"],c.maxPointCount=3,b.calibrate(c,a.axesParameters.isRange100,a.axesParameters.isNormalOrientation)):"MapAxes"===a.axesType?(b=new wpd.MapAxes,c.labels=["P1","P2"],c.labelPositions=["S","S"],c.maxPointCount=2,b.calibrate(c,a.axesParameters.scaleLength,a.axesParameters.unitString)):"ImageAxes"===a.axesType&&(b=new wpd.ImageAxes);null!=b&&this._axesColl.push(b);if(null!=a.dataSeries)for(c=0;c<a.dataSeries.length;c++){var d=a.dataSeries[c],
e=new wpd.Dataset;e.name=d.name;null!=d.metadataKeys&&e.setMetadataKeys(d.metadataKeys);for(var f=0;f<d.data.length;f++)e.addPixel(d.data[f].x,d.data[f].y,d.data[f].metadata);this.addDataset(e);this.setAxesForDataset(e,b)}if(null!=a.distanceMeasurementData){c=new wpd.DistanceMeasurement;for(d=0;d<a.distanceMeasurementData.length;d++)c.addConnection(a.distanceMeasurementData[d]);this.addMeasurement(c);b instanceof wpd.MapAxes&&this.setAxesForMeasurement(c,b)}if(null!=a.angleMeasurementData){b=new wpd.AngleMeasurement;
for(c=0;c<a.angleMeasurementData.length;c++)b.addConnection(a.angleMeasurementData[c]);this.addMeasurement(b)}return!0};
wpd.PlotData.prototype._deserializeVersion4=function(a){if(null!=a.axesColl)for(var c=0;c<a.axesColl.length;c++){var b=a.axesColl[c],d=null;if("ImageAxes"!==b.type)for(var d="TernaryAxes"===b.type?new wpd.Calibration(3):new wpd.Calibration(2),e=0;e<b.calibrationPoints.length;e++)d.addPoint(b.calibrationPoints[e].px,b.calibrationPoints[e].py,b.calibrationPoints[e].dx,b.calibrationPoints[e].dy,b.calibrationPoints[e].dz);e=null;"XYAxes"===b.type?(e=new wpd.XYAxes,d.labels=["X1","X2","Y1","Y2"],d.labelPositions=
["N","N","E","E"],d.maxPointCount=4,e.calibrate(d,b.isLogX,b.isLogY)):"BarAxes"===b.type?(e=new wpd.BarAxes,d.labels=["P1","P2"],d.labelPositions=["S","S"],d.maxPointCount=2,e.calibrate(d,b.isLog,null==b.isRotated?!1:b.isRotated)):"PolarAxes"===b.type?(e=new wpd.PolarAxes,d.labels=["Origin","P1","P2"],d.labelPositions=["E","S","S"],d.maxPointCount=3,e.calibrate(d,b.isDegrees,b.isClockwise,b.isLog)):"TernaryAxes"===b.type?(e=new wpd.TernaryAxes,d.labels=["A","B","C"],d.labelPositions=["S","S","E"],
d.maxPointCount=3,e.calibrate(d,b.isRange100,b.isNormalOrientation)):"MapAxes"===b.type?(e=new wpd.MapAxes,d.labels=["P1","P2"],d.labelPositions=["S","S"],d.maxPointCount=2,e.calibrate(d,b.scaleLength,b.unitString)):"ImageAxes"===b.type&&(e=new wpd.ImageAxes);null!=e&&(e.name=b.name,this._axesColl.push(e))}if(null!=a.datasetColl)for(c=0;c<a.datasetColl.length;c++){d=a.datasetColl[c];b=new wpd.Dataset;b.name=d.name;null!=d.metadataKeys&&b.setMetadataKeys(d.metadataKeys);for(e=0;e<d.data.length;e++)b.addPixel(d.data[e].x,
d.data[e].y,d.data[e].metadata);this._datasetColl.push(b);d=this.getAxesNames().indexOf(d.axesName);0<=d&&this.setAxesForDataset(b,this._axesColl[d])}if(null!=a.measurementColl)for(c=0;c<a.measurementColl.length;c++)if(b=a.measurementColl[c],d=null,"Distance"===b.type?(d=new wpd.DistanceMeasurement,this._measurementColl.push(d),e=this.getAxesNames().indexOf(b.axesName),0<=e&&this.setAxesForMeasurement(d,this._axesColl[e])):"Angle"===b.type?(d=new wpd.AngleMeasurement,this._measurementColl.push(d)):
"Area"===b.type&&(d=new wpd.AreaMeasurement,this._measurementColl.push(d),e=this.getAxesNames().indexOf(b.axesName),0<=e&&this.setAxesForMeasurement(d,this._axesColl[e])),null!=d)for(e=0;e<b.data.length;e++)d.addConnection(b.data[e]);return!0};wpd.PlotData.prototype.deserialize=function(a){this.reset();try{return null!=a.wpd&&3===a.wpd.version[0]?this._deserializePreVersion4(a.wpd):null!=a.version&&4===a.version[0]?this._deserializeVersion4(a):!0}catch(c){return console.log(c),!1}};
wpd.PlotData.prototype.serialize=function(){for(var a={version:[4,0],axesColl:[],datasetColl:[],measurementColl:[]},c=0;c<this._axesColl.length;c++){var b=this._axesColl[c],d={};d.name=b.name;b instanceof wpd.XYAxes?(d.type="XYAxes",d.isLogX=b.isLogX(),d.isLogY=b.isLogY()):b instanceof wpd.BarAxes?(d.type="BarAxes",d.isLog=b.isLog(),d.isRotated=b.isRotated()):b instanceof wpd.PolarAxes?(d.type="PolarAxes",d.isDegrees=b.isThetaDegrees(),d.isClockwise=b.isThetaClockwise(),d.isLog=b.isRadialLog()):b instanceof
wpd.TernaryAxes?(d.type="TernaryAxes",d.isRange100=b.isRange100(),d.isNormalOrientation=b.isNormalOrientation):b instanceof wpd.MapAxes?(d.type="MapAxes",d.scaleLength=b.getScaleLength(),d.unitString=b.getUnits()):b instanceof wpd.ImageAxes&&(d.type="ImageAxes");if(!(b instanceof wpd.ImageAxes)){d.calibrationPoints=[];for(var e=0;e<b.calibration.getCount();e++)d.calibrationPoints.push(b.calibration.getPoint(e))}a.axesColl.push(d)}for(c=0;c<this._datasetColl.length;c++){b=this._datasetColl[c];d=this.getAxesForDataset(b);
e={};e.name=b.name;e.axesName=null!=d?d.name:"";e.metadataKeys=b.getMetadataKeys();e.data=[];for(var f=0;f<b.getCount();f++){var g=b.getPixel(f);e.data[f]=g;null!=d&&(e.data[f].value=d.pixelToData(g.x,g.y))}a.datasetColl.push(e)}for(c=0;c<this._measurementColl.length;c++){b=this._measurementColl[c];e=this.getAxesForMeasurement(b);d={};b instanceof wpd.DistanceMeasurement?(d.type="Distance",d.name="Distance",d.axesName=null!=e?e.name:""):b instanceof wpd.AngleMeasurement?(d.type="Angle",d.name="Angle"):
b instanceof wpd.AreaMeasurement&&(d.type="Area",d.name="Area",d.axesName=null!=e?e.name:"");d.data=[];for(e=0;e<b.connectionCount();e++)d.data.push(b.getConnectionAt(e));a.measurementColl.push(d)}return a};wpd=wpd||{};
wpd.AveragingWindowCore=function(){return function(a,c,b,d,e,f){this.run=function(){var g=[],h=0,k=[],l,n,m,p;f.clearAll();for(l=0;l<b;l++){var q=-1;var r=-2*e;for(n=m=0;n<c;n++)!0===a[n*b+l]&&(n>r+e?(q+=1,m=1,r=k[q]=n):(m+=1,k[q]=parseFloat((k[q]*(m-1)+n)/parseFloat(m))));if(0<=q)for(r=l+.5,n=0;n<=q;n++)m=k[n]+.5,g[h]=[],g[h][0]=parseFloat(r),g[h][1]=parseFloat(m),g[h][2]=!0,h+=1}if(0!==h){for(k=0;k<h;k++)if(!0===g[k][2]){l=!0;q=k+1;n=g[k][0];r=g[k][1];m=n;var u=r;for(p=1;!0===l&&q<h;){var v=g[q][0];
var t=g[q][1];Math.abs(v-n)<=d&&Math.abs(t-r)<=e&&!0===g[q][2]&&(m=(m*p+v)/(p+1),u=(u*p+t)/(p+1),p+=1,g[q][2]=!1);v>n+2*d&&(l=!1);q+=1}g[k][2]=!1;f.addPixel(parseFloat(m),parseFloat(u))}return f}}}}();wpd=wpd||{};
wpd.AveragingWindowAlgo=function(){return function(){var a=5,c=5;this.getParamList=function(b){return[["\u0394X","Px",10],["\u0394Y","Px",10]]};this.setParam=function(b,d){0===b?a=d:1===b&&(c=d)};this.run=function(b,d,e){(new wpd.AveragingWindowCore(b.binaryData,b.imageHeight,b.imageWidth,a,c,d)).run()}}}();wpd=wpd||{};
wpd.AveragingWindowWithStepSizeAlgo=function(){return function(){var a,c,b,d,e,f;this.getParamList=function(b){return null!=b&&b instanceof wpd.XYAxes?(b=b.getBounds(),[["X_min","Units",b.x1],["\u0394X Step","Units",.1],["X_max","Units",b.x2],["Y_min","Units",b.y3],["Y_max","Units",b.y4],["Line width","Px",30]]):[["X_min","Units",0],["\u0394X Step","Units",.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Line width","Px",30]]};this.setParam=function(g,h){0===g?a=h:1===g?c=h:2===g?
b=h:3===g?e=h:4===g?f=h:5===g&&(d=h)};this.run=function(g,h,k){var l=g.imageWidth,n=g.imageHeight,m,p;h.clearAll();for(m=a;m<=b;m+=c){var q=k.dataToPixel(m,e);var r=q.x;var u=q.y;q=k.dataToPixel(m,f);var v=q.x;var t=q.y;r=Math.sqrt((t-u)*(t-u)+(v-r)*(v-r));v=(f-e)/r;u=!1;var w=t=0;var A=!1;for(p=0;p<=r;p++)q=1*-p*v+f,q=k.dataToPixel(m,q),xi_pix=q.x,yi_pix=q.y,0<=xi_pix&&xi_pix<l&&0<=yi_pix&&yi_pix<n&&(!0===g.binaryData[parseInt(yi_pix,10)*l+parseInt(xi_pix,10)]?(!1===u&&(w=t=p,u=!0,A=!1),!0===A&&
(w=p,A=!1)):!1===A&&(w=p,A=!0),!0===u&&(p>t+d||p==r-1)&&(u=!1,t>w&&(w=p),q=(t+w)/2,q=1*-q*v+f,q=k.dataToPixel(m,q),h.addPixel(parseFloat(q.x),parseFloat(q.y))))}}}}();wpd=wpd||{};
wpd.BarValue=function(){this.avgX=this.avgValBot=this.avgValTop=this.npoints=0;this.append=function(a,c,b){this.avgX=(this.npoints*this.avgX+a)/(this.npoints+1);this.avgValTop=(this.npoints*this.avgValTop+c)/(this.npoints+1);this.avgValBot=(this.npoints*this.avgValBot+b)/(this.npoints+1);this.npoints++};this.isPointInGroup=function(a,c,b,d,e){return 0===this.npoints||Math.abs(this.avgX-a)<=d&&Math.abs(this.avgValTop-c)<=e&&Math.abs(this.avgValBot-b)<=e?!0:!1}};
wpd.BarExtractionAlgo=function(){var a,c;this.getParamList=function(b){return"Y"===b.getOrientation().axes?[["\u0394X","Px",30],["\u0394Val","Px",10]]:[["\u0394Y","Px",30],["\u0394Val","Px",10]]};this.setParam=function(b,d){0===b?a=parseFloat(d):1===b&&(c=parseFloat(d))};this.run=function(b,d,e){var f=e.getOrientation(),g=[],h,k,l,n=b.imageWidth,m=b.imageHeight,p,q,r=function(b,d,e){p=!1;for(q=0;q<g.length;q++)if(t=g[q],t.isPointInGroup(b,d,e,a,c)){t.append(b,d,e);p=!0;break}p||(t=new wpd.BarValue,
t.append(b,d,e),g.push(t))};d.clearAll();if("Y"===f.axes)for(k=0;k<n;k++){var u=0;var v=m-1;for(l=h=0;l<m;l++)if(b.binaryData[l*n+k]){u=l;h++;break}for(l=m-1;0<=l;l--)if(b.binaryData[l*n+k]){v=l;h++;break}2===h&&r(k,u,v)}else for(l=0;l<m;l++){u=n-1;h=v=0;for(k=n-1;0<=k;k--)if(b.binaryData[l*n+k]){u=k;h++;break}for(k=0;k<n;k++)if(b.binaryData[l*n+k]){v=k;h++;break}2===h&&r(l,u,v)}e.dataPointsHaveLabels&&(b=d.getMetadataKeys(),null!=b&&"Label"===b[0]||d.setMetadataKeys(["Label"]));for(q=0;q<g.length;q++){var t=
g[q];"Y"===f.axes?(u=e.pixelToData(t.avgX,t.avgValTop)[0],v=e.pixelToData(t.avgX,t.avgValBot)[0]):(u=e.pixelToData(t.avgValTop,t.avgX)[0],v=e.pixelToData(t.avgValBot,t.avgX)[0]);b=0>u+v?"increasing"===f.direction?t.avgValBot:t.avgValTop:"increasing"===f.direction?t.avgValTop:t.avgValBot;e.dataPointsHaveLabels?"Y"===f.axes?d.addPixel(t.avgX+.5,b+.5,["Bar"+q]):d.addPixel(b+.5,t.avgX+.5,["Bar"+q]):"Y"===f.axes?d.addPixel(t.avgX+.5,b+.5):d.addPixel(b+.5,t.avgX+.5)}}};wpd=wpd||{};
wpd.BlobDetectorAlgo=function(){return function(){var a,c;this.getParamList=function(b){return null!=b&&b instanceof wpd.MapAxes?[["Min Diameter","Units",0],["Max Diameter","Units",5E3]]:[["Min Diameter","Px",0],["Max Diameter","Px",5E3]]};this.setParam=function(b,d){0===b?a=parseFloat(d):1===b&&(c=parseFloat(d))};this.run=function(b,d,e){var f=b.imageWidth,g=b.imageHeight,h=[],k=[],l,n,m,p,q;if(!(0>=f||0>=g||null==b.binaryData||0===b.binaryData.length)){d.clearAll();d.setMetadataKeys(["area","moment"]);
for(l=0;l<f;l++)for(n=0;n<g;n++)if(!0===b.binaryData[n*f+l]&&!0!==h[n*f+l]){h[n*f+l]=!0;var r=k.length;k[r]={pixels:[{x:l,y:n}],centroid:{x:l,y:n},area:1,moment:0};for(m=0;m<k[r].pixels.length;){var u=k[r].pixels[m].x;var v=k[r].pixels[m].y;for(p=u-1;p<=u+1;p++)for(q=v-1;q<=v+1;q++)if(0<=p&&0<=q&&p<f&&q<g&&!0!==h[q*f+p]&&!0===b.binaryData[q*f+p]){h[q*f+p]=!0;var t=k[r].pixels.length;k[r].pixels[t]={x:p,y:q};k[r].centroid.x=(k[r].centroid.x*t+p)/(t+1);k[r].centroid.y=(k[r].centroid.y*t+q)/(t+1);k[r].area+=
1}m+=1}}for(r=0;r<k.length;r++){for(m=k[r].moment=0;m<k[r].pixels.length;m++)k[r].moment=k[r].moment+(k[r].pixels[m].x-k[r].centroid.x)*(k[r].pixels[m].x-k[r].centroid.x)+(k[r].pixels[m].y-k[r].centroid.y)*(k[r].pixels[m].y-k[r].centroid.y);e instanceof wpd.MapAxes&&(k[r].area=plotData.axes.pixelToDataArea(k[r].area));b=2*Math.sqrt(k[r].area/Math.PI);b<=c&&b>=a&&d.addPixel(k[r].centroid.x+.5,k[r].centroid.y+.5,[k[r].area,k[r].moment])}}}}}();wpd=wpd||{};
wpd.XStepWithInterpolationAlgo=function(){return function(){var a,c,b,d,e,f;this.getParamList=function(b){return null!=b&&b instanceof wpd.XYAxes?(b=b.getBounds(),[["X_min","Units",b.x1],["\u0394X Step","Units",(b.x2-b.x1)/50],["X_max","Units",b.x2],["Y_min","Units",b.y3],["Y_max","Units",b.y4],["Smoothing","% of \u0394X",0]]):[["X_min","Units",0],["\u0394X Step","Units",.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Smoothing","% of \u0394X",0]]};this.setParam=function(g,h){0===
g?a=h:1===g?c=h:2===g?b=h:3===g?e=h:4===g?f=h:5===g&&(d=h)};this.run=function(g,h,k){var l=0,n=g.imageWidth,m=g.imageHeight,p,q,r=[],u=[],v=Math.abs(d/100*c);h.clearAll();var t=k.dataToPixel(a,e);var w=k.dataToPixel(a,f);var A=(f-e)/Math.sqrt((t.x-w.x)*(t.x-w.x)+(t.y-w.y)*(t.y-w.y));w=k.dataToPixel(b,e);w=(b-a)/Math.sqrt((t.x-w.x)*(t.x-w.x)+(t.y-w.y)*(t.y-w.y));0<Math.abs(v/w)&&1>Math.abs(v/w)&&(v=w);for(t=a;0<w&&t<=b||0>w&&t>=b;){var B=q=0;for(p=e;0<A&&p<=f||0>A&&p>=f;){var x=k.dataToPixel(t,p);
0<x.x&&0<x.y&&x.x<n&&x.y<m&&!0===g.binaryData[parseInt(x.y,10)*n+parseInt(x.x,10)]&&(q=(q*B+p)/parseFloat(B+1),B++);p+=A}0<B&&(r[l]=parseFloat(t),u[l]=parseFloat(q),l+=1);t+=w}if(!(0>=r.length||0>=u.length)){if(0<v)for(x=[],l=[],t=r[0];0<w&&t<=r[r.length-1]||0>w&&t>=r[r.length-1];){for(g=B=m=n=0;g<r.length;g++)r[g]<=t+v&&r[g]>=t-v&&(n=(n*B+r[g])/parseFloat(B+1),m=(m*B+u[g])/parseFloat(B+1),B++);0<B&&(x[x.length]=n,l[l.length]=m);t=0<w?t+v:t-v}else x=r,l=u;if(!(0>=x.length||0>=l.length||(r=[],g=0,
t=a,0>w&&0<c||0<w&&0>c))){for(;0<w&&t<=b||0>w&&t>=b;)r[g]=t,g++,t+=c;0>w&&(x=x.reverse(),l=l.reverse());v=wpd.cspline(x,l);if(null!=v)for(u=[],g=0;g<r.length;++g)isNaN(r[g])||(u[g]=wpd.cspline_interp(v,r[g]),null!==u[g]&&(x=k.dataToPixel(r[g],u[g]),h.addPixel(x.x,x.y)))}}}}}();wpd=wpd||{};
wpd.BarAxes=function(){var a=function(){var a=!1,b=!1,d=!1,e,f,g,h,k,l,n;this.isCalibrated=function(){return a};this.calibration=null;this.calibrate=function(c,p,q){this.calibration=c;a=!1;var m=c.getPoint(0);c=c.getPoint(1);e=m.px;f=m.py;g=c.px;h=c.py;k=parseFloat(m.dy);l=parseFloat(c.dy);p?(b=!0,k=Math.log(k)/Math.log(10),l=Math.log(l)/Math.log(10)):b=!1;n=this.calculateOrientation();d=q;q||("Y"==n.axes?g=e:h=f,n=this.calculateOrientation());return a=!0};this.pixelToData=function(a,c){var d=[];
d[0]=((c-f)*(h-f)+(g-e)*(a-e))/((h-f)*(h-f)+(g-e)*(g-e))*(l-k)+k;b&&(d[0]=Math.pow(10,d[0]));return d};this.dataToPixel=function(b,a){return{x:0,y:0}};this.pixelToLiveString=function(b,a){return this.pixelToData(b,a)[0].toExponential(4)};this.isLog=function(){return b};this.isRotated=function(){return d};this.getTransformationEquations=function(){return{pixelToData:["This will be available in a future release."]}};this.dataPointsHaveLabels=!0;this.dataPointsLabelPrefix="Bar";this.calculateOrientation=
function(){var b=180*wpd.taninverse(-(h-f),g-e)/Math.PI,a={axes:"Y",direction:"increasing",angle:b};30>Math.abs(b-90)?(a.axes="Y",a.direction="increasing"):30>Math.abs(b-270)?(a.axes="Y",a.direction="decreasing"):30>Math.abs(b-0)||30>Math.abs(b-360)?(a.axes="X",a.direction="increasing"):30>Math.abs(b-180)&&(a.axes="X",a.direction="decreasing");return a};this.getOrientation=function(){return n};this.name="Bar"};a.prototype.numCalibrationPointsRequired=function(){return 2};a.prototype.getDimensions=
function(){return 2};a.prototype.getAxesLabels=function(){return["Label","Y"]};return a}();wpd=wpd||{};
wpd.ImageAxes=function(){var a=function(){this.isCalibrated=function(){return!0};this.calibrate=function(){return!0};this.pixelToData=function(a,b){return[a,b]};this.dataToPixel=function(a,b){return{x:a,y:b}};this.pixelToLiveString=function(a,b){a=this.pixelToData(a,b);return a[0].toFixed(2)+", "+a[1].toFixed(2)};this.getTransformationEquations=function(){return{pixelToData:["x_data = x_pixel","y_data = y_pixel"],dataToPixel:["x_pixel = x_data","y_pixel = y_data"]}};this.name="Image"};a.prototype.numCalibrationPointsRequired=
function(){return 0};a.prototype.getDimensions=function(){return 2};a.prototype.getAxesLabels=function(){return["X","Y"]};return a}();wpd=wpd||{};
wpd.MapAxes=function(){var a=function(){var a=!1,b,d,e;this.calibration=null;this.isCalibrated=function(){return a};this.calibrate=function(c,g,h){this.calibration=c;var f=c.getPoint(0);c=c.getPoint(1);e=Math.sqrt((f.px-c.px)*(f.px-c.px)+(f.py-c.py)*(f.py-c.py));b=parseFloat(g);d=h;return a=!0};this.pixelToData=function(a,c){var d=[];d[0]=a*b/e;d[1]=c*b/e;return d};this.pixelToDataDistance=function(a){return a*b/e};this.pixelToDataArea=function(a){return a*b*b/(e*e)};this.dataToPixel=function(b,a,
c){return{x:0,y:0}};this.pixelToLiveString=function(b,a){b=this.pixelToData(b,a);return b[0].toExponential(4)+", "+b[1].toExponential(4)};this.getScaleLength=function(){return b};this.getUnits=function(){return d};this.getTransformationEquations=function(){return{pixelToData:["x_data = "+b/e+"*x_pixel","y_data = "+b/e+"*y_pixel"],dataToPixel:["x_pixel = "+e/b+"*x_data","y_pixel = "+e/b+"*y_data"]}};this.name="Map"};a.prototype.numCalibrationPointsRequired=function(){return 2};a.prototype.getDimensions=
function(){return 2};a.prototype.getAxesLabels=function(){return["X","Y"]};return a}();wpd=wpd||{};
wpd.PolarAxes=function(){var a=function(){var a=!1,b=!1,d=!1,e=!1,f,g,h,k,l,n,m,p,q,r,u,v,t,w;processCalibration=function(a,c,x,y){var A=a.getPoint(0),E=a.getPoint(1);a=a.getPoint(2);f=A.px;g=A.py;h=E.px;k=E.py;l=a.px;n=a.py;m=E.dx;p=E.dy;q=a.dx;b=c;d=x;!0===b&&(p*=Math.PI/180);y&&(e=!0,m=Math.log(m)/Math.log(10),q=Math.log(q)/Math.log(10));r=Math.sqrt((h-f)*(h-f)+(k-g)*(k-g));u=Math.sqrt((l-f)*(l-f)+(n-g)*(n-g));v=u-r;t=wpd.taninverse(-(k-g),h-f);w=d?t+p:t-p;return!0};this.calibration=null;this.isCalibrated=
function(){return a};this.calibrate=function(b,c,d,e){this.calibration=b;return a=processCalibration(b,c,d,e)};this.isThetaDegrees=function(){return b};this.isThetaClockwise=function(){return d};this.isRadialLog=function(){return e};this.pixelToData=function(a,c){var h=[];xp=parseFloat(a);yp=parseFloat(c);a=(q-m)/v*(Math.sqrt((xp-f)*(xp-f)+(yp-g)*(yp-g))-r)+m;c=d?w-wpd.taninverse(-(yp-g),xp-f):wpd.taninverse(-(yp-g),xp-f)-w;0>c&&(c+=2*Math.PI);!0===b&&(c=180*c/Math.PI);e&&(a=Math.pow(10,a));h[0]=
a;h[1]=c;return h};this.dataToPixel=function(b,a){return{x:0,y:0}};this.pixelToLiveString=function(b,a){b=this.pixelToData(b,a);return b[0].toExponential(4)+", "+b[1].toExponential(4)};this.getTransformationEquations=function(){var a="r = ("+(q-m)/v+")*sqrt((x_pixel - "+f+")^2 + (y_pixel - "+g+")^2) + ("+(m-r*(q-m)/v)+")";var c=d?w+"- atan2(("+g+" - y_pixel), (x_pixel - "+f+"))":"atan2(("+g+" - y_pixel), (x_pixel - "+f+")) - ("+w+")";c=b?"theta = (180/PI)*("+c+"), theta = theta + 360 if theta < 0":
"theta = "+c+" theta = theta + 2*PI if theta < 0";return{pixelToData:[a,c]}};this.name="Polar"};a.prototype.numCalibrationPointsRequired=function(){return 3};a.prototype.getDimensions=function(){return 2};a.prototype.getAxesLabels=function(){return["r","\u03b8"]};return a}();wpd=wpd||{};
wpd.TernaryAxes=function(){var a=function(){var a=!1,b,d,e,f,g,h,k,l,n;this.isCalibrated=function(){return a};this.calibration=null;this.calibrate=function(c,p,q){this.calibration=c;var m=c.getPoint(0),u=c.getPoint(1);c.getPoint(2);b=m.px;d=m.py;e=u.px;f=u.py;g=Math.sqrt((b-e)*(b-e)+(d-f)*(d-f));h=wpd.taninverse(-(f-d),e-b);k=Math.sqrt(3);l=p;n=q;return a=!0};this.isRange100=function(){return l};this.isNormalOrientation=function(){return n};this.pixelToData=function(a,c){var e=[];xp=parseFloat(a);
yp=parseFloat(c);a=Math.sqrt((xp-b)*(xp-b)+(yp-d)*(yp-d));var f=wpd.taninverse(-(yp-d),xp-b)-h;c=a*Math.cos(f)/g;f=a*Math.sin(f)/g;a=1-c-f/k;c-=f/k;f=2*f/k;if(0==n){var m=c;c=a;a=f;f=m}1==l&&(a*=100,c*=100,f*=100);e[0]=a;e[1]=c;e[2]=f;return e};this.dataToPixel=function(b,a,c){return{x:0,y:0}};this.pixelToLiveString=function(b,a){b=this.pixelToData(b,a);return b[0].toExponential(4)+", "+b[1].toExponential(4)+", "+b[2].toExponential(4)};this.getTransformationEquations=function(){var a="rp = sqrt((x_pixel - "+
b+")^2 + (y_pixel - "+d+")^2)/("+g+")",c="thetap = atan2(("+d+" -  y_pixel), (x_pixel - "+b+")) - ("+Math.atan2(-(f-d),e-b)+")",h="1 - rp*(cos(thetap) - sin(thetap)/sqrt(3))",k="rp*(cos(thetap) - sin(thetap)/sqrt(3))",u="2*rp*sin(thetap)/sqrt(3)";l&&(h="100*("+h+")",k="100*("+k+")",u="100*("+u+")");h="a_data = "+h;k="b_data = "+k;u="c_data = "+u;if(!n){var v=k;k=h;h=u;u=v}return{pixelToData:[a,c,h,k,u]}};this.name="Ternary"};a.prototype.numCalibrationPointsRequired=function(){return 3};a.prototype.getDimensions=
function(){return 3};a.prototype.getAxesLabels=function(){return["a","b","c"]};return a}();wpd=wpd||{};
wpd.XYAxes=function(){var a=function(){var a=!1,b=!1,d=!1,e=!1,f=!1,g,h,k,l,n,m,p,q,r,u,v,t,w,A,B=[0,0,0,0],x=[0,0,0,0],y=[0,0],H=function(a,c,L){if(4>a.getCount())return!1;var E=a.getPoint(0),K=a.getPoint(1),H=a.getPoint(2);a=a.getPoint(3);var G=new wpd.InputParser;k=E.px;p=E.py;l=K.px;q=K.py;n=H.px;r=H.py;m=a.px;u=a.py;v=E.dx;t=K.dx;w=H.dy;A=a.dy;v=G.parse(v);if(!G.isValid)return!1;e=G.isDate;t=G.parse(t);if(!G.isValid||G.isDate!=e)return!1;g=G.formatting;w=G.parse(w);if(!G.isValid)return!1;f=G.isDate;
A=G.parse(A);if(!G.isValid||G.isDate!=f)return!1;h=G.formatting;b=c;d=L;!0===b&&(v=Math.log(v)/Math.log(10),t=Math.log(t)/Math.log(10));!0===d&&(w=Math.log(w)/Math.log(10),A=Math.log(A)/Math.log(10));B=wpd.mat.mult2x2([v-t,0,0,w-A],wpd.mat.inv2x2([k-l,n-m,p-q,r-u]));x=wpd.mat.inv2x2(B);y[0]=v-B[0]*k-B[1]*p;y[1]=w-B[2]*n-B[3]*r;return!0};this.getBounds=function(){return{x1:b?Math.pow(10,v):v,x2:b?Math.pow(10,t):t,y3:d?Math.pow(10,w):w,y4:d?Math.pow(10,A):A}};this.isCalibrated=function(){return a};
this.calibration=null;this.calibrate=function(b,c,d){this.calibration=b;return a=H(b,c,d)};this.pixelToData=function(a,c){var e=[];a=parseFloat(a);c=parseFloat(c);a=wpd.mat.mult2x2Vec(B,[a,c]);a[0]+=y[0];a[1]+=y[1];c=a[0];a=a[1];!0===b&&(c=Math.pow(10,c));!0===d&&(a=Math.pow(10,a));e[0]=c;e[1]=a;return e};this.dataToPixel=function(a,c){b&&(a=Math.log(a)/Math.log(10));d&&(c=Math.log(c)/Math.log(10));a=wpd.mat.mult2x2Vec(x,[a-y[0],c-y[1]]);return{x:a[0],y:a[1]}};this.pixelToLiveString=function(a,b){var c=
"";a=this.pixelToData(a,b);c=e?c+wpd.dateConverter.formatDateNumber(a[0],g):c+a[0].toExponential(4);c+=", ";return c=f?c+wpd.dateConverter.formatDateNumber(a[1],h):c+a[1].toExponential(4)};this.isDate=function(a){return 0===a?e:f};this.getInitialDateFormat=function(a){return 0===a?g:h};this.isLogX=function(){return b};this.isLogY=function(){return d};this.getTransformationEquations=function(){var a="("+B[0]+")*x_pixel + ("+B[1]+")*y_pixel + ("+y[0]+")",c="("+B[2]+")*x_pixel + ("+B[3]+")*y_pixel + ("+
y[1]+")",e="x_pixel = ("+x[0]+")*x_data + ("+x[1]+")*y_data + ("+(-x[0]*y[0]-x[1]*y[1])+")",f="y_pixel = ("+x[2]+")*x_data + ("+x[3]+")*y_data + ("+(-x[2]*y[0]-x[3]*y[1])+")",a=b?"x_data = pow(10, "+a+")":"x_data = "+a,c=d?"y_data = pow(10, "+c+")":"y_data = "+c;return b||d?{pixelToData:[a,c]}:{pixelToData:[a,c],dataToPixel:[e,f]}};this.getOrientation=function(){return{axes:"Y",direction:"increasing",angle:90}};this.name="XY"};a.prototype.numCalibrationPointsRequired=function(){return 4};a.prototype.getDimensions=
function(){return 2};a.prototype.getAxesLabels=function(){return["X","Y"]};return a}();wpd=wpd||{};
wpd.dataTable=function(){function a(){wpd.graphicsWidget.removeTool();wpd.popup.show("csvWindow");document.getElementById("data-number-format-separator").value.trim()===p&&(document.getElementById("data-number-format-separator").value=","===p?"; ":", ");c()}function c(){h=g.getData();b();e();f()}function b(){document.getElementById("data-table-dataset-control");var a=document.getElementById("data-table-dataset-list"),b=document.getElementById("data-sort-variables"),c=document.getElementById("dataVariables"),
e=document.getElementById("data-date-formatting-container"),f=document.getElementById("data-date-formatting"),g="",k="",l="",p=!1,y=null!=m;null!=n?(wpd.appData.getPlotData().getDatasetNames().forEach(function(a){g+='<option value="'+a+'">'+a+"</option>"}),a.innerHTML=g,a.value=n.name):y&&(0<wpd.appData.getPlotData().getMeasurementsByType(wpd.AreaMeasurement).length&&(g+='<option value="area">'+wpd.gettext("area-measurements")+"</option>"),0<wpd.appData.getPlotData().getMeasurementsByType(wpd.AngleMeasurement).length&&
(g+='<option value="angle">'+wpd.gettext("angle-measurements")+"</option>"),0<wpd.appData.getPlotData().getMeasurementsByType(wpd.DistanceMeasurement).length&&(g+='<option value="distance">'+wpd.gettext("distance-measurements")+"</option>"),a.innerHTML=g,m instanceof wpd.AngleMeasurement?a.value="angle":m instanceof wpd.DistanceMeasurement?a.value="distance":m instanceof wpd.AreaMeasurement&&(a.value="area"));c.innerHTML=h.fields.join(", ");e.style.display="none";k+='<option value="raw">'+wpd.gettext("raw")+
"</option>";for(a=0;a<h.fields.length;a++)h.isFieldSortable[a]&&(k+='<option value="'+h.fields[a]+'">'+h.fields[a]+"</option>"),null!=h.fieldDateFormat[a]&&(l+="<p>"+h.fields[a]+' <input type="text" length="15" value="'+h.fieldDateFormat[a]+'" id="data-format-string-'+a+'"/></p>',p=!0);h.allowConnectivity&&(k+='<option value="NearestNeighbor">'+wpd.gettext("nearest-neighbor")+"</option>");b.innerHTML=k;d();p?(e.style.display="inline-block",f.innerHTML=l):e.style.display="hidden"}function d(){var a=
document.getElementById("data-sort-variables").value,b=document.getElementById("data-sort-order");"NearestNeighbor"===a||"raw"===a?b.setAttribute("disabled",!0):b.removeAttribute("disabled")}function e(){if(null!=h&&null!=h.rawData){k=h.rawData.slice(0);var a=document.getElementById("data-sort-variables").value,b="ascending"===document.getElementById("data-sort-order").value,c="NearestNeighbor"===a;if("raw"!==a)if(!c){var d=h.fields.indexOf(a);0>d||k.sort(function(a,c){return a[d]>c[d]?b?1:-1:a[d]<
c[d]?b?-1:1:0})}else if(c)for(var e,f,g,l=k.length,n=h.connectivityFieldIndices,m,p,c=0;c<l-1;c++){a=-1;for(g=c+1;g<l;g++){for(m=f=0;m<n.length;m++)p=n[m],f+=(k[c][p]-k[g][p])*(k[c][p]-k[g][p]);if(f<e||-1===a)e=f,a=g}for(m=0;m<h.fields.length;m++)f=k[a][m],k[a][m]=k[c+1][m],k[c+1][m]=f}}}function f(){if(null!=k){var a=document.getElementById("digitizedDataTable"),b=parseInt(document.getElementById("data-number-format-digits").value,10),c=document.getElementById("data-number-format-style").value,d=
document.getElementById("data-number-format-separator").value,e,f,g=[],d=d.replace(/[^\\]\\t/,"\t").replace(/^\\t/,"\t");l="";for(e=0;e<k.length;e++){var n=[];for(f=0;f<h.fields.length;f++)null!=h.fieldDateFormat[f]?(void 0===g[f]&&(g[f]=document.getElementById("data-format-string-"+f).value),n[f]=wpd.dateConverter.formatDateNumber(k[e][f],g[f])):(n[f]="string"===typeof k[e][f]?k[e][f]:"fixed"===c&&0<=b?k[e][f].toFixed(b):"precision"===c&&0<=b?k[e][f].toPrecision(b):"exponential"===c&&0<=b?k[e][f].toExponential(b):
k[e][f],n[f]=n[f].toString().replace(".",p));l+=n.join(d);l+="\n"}a.value=l}}var g,h,k,l,n,m,p=(1.1).toLocaleString().replace(/\d/g,"");return{showTable:function(){g=wpd.plotDataProvider;n=wpd.tree.getActiveDataset();m=null;g.setDataSource(n);a()},showAngleData:function(){g=wpd.measurementDataProvider;m=wpd.appData.getPlotData().getMeasurementsByType(wpd.AngleMeasurement)[0];n=null;g.setDataSource(m);a()},showAreaData:function(){g=wpd.measurementDataProvider;m=wpd.appData.getPlotData().getMeasurementsByType(wpd.AreaMeasurement)[0];
n=null;g.setDataSource(m);a()},showDistanceData:function(){g=wpd.measurementDataProvider;m=wpd.appData.getPlotData().getMeasurementsByType(wpd.DistanceMeasurement)[0];n=null;g.setDataSource(m);a()},updateSortingControls:d,reSort:function(){d();e();f()},copyToClipboard:function(){var a=document.getElementById("digitizedDataTable");a.focus();a.select();try{document.execCommand("copy")}catch(r){console.log("copyToClipboard",r.message)}},generateCSV:function(){wpd.download.csv(l,(null!=n?n.name:m instanceof
wpd.AngleMeasurement?"angles":"distances")+".csv")},exportToPlotly:function(){if(null!=k){var a={data:[]},b,c;a.data[0]={};for(b=0;b<k.length;b++)for(c=0;c<h.fields.length;c++){var d=h.fields[c];0===c?d="x":1===c&&(d="y");0===b&&(a.data[0][d]=[]);a.data[0][d][b]=null!=h.fieldDateFormat[c]?wpd.dateConverter.formatDateNumber(k[b][c],"yyyy-mm-dd hh:ii:ss"):k[b][c]}wpd.plotly.send(a)}},changeDataset:function(){var a=document.getElementById("data-table-dataset-list");null!=n?(n=wpd.appData.getPlotData().getDatasets()[a.selectedIndex],
g.setDataSource(n)):null!=m&&("angle"===a.value?m=wpd.appData.getPlotData().getMeasurementsByType(wpd.AngleMeasurement)[0]:"distance"===a.value?m=wpd.appData.getPlotData().getMeasurementsByType(wpd.DistanceMeasurement)[0]:"area"===a.value&&(m=wpd.appData.getPlotData().getMeasurementsByType(wpd.AreaMeasurement)[0]),g.setDataSource(m));c()}}}();wpd=wpd||{};
wpd.graphicsWidget=function(){function a(a){var b=w.getBoundingClientRect();return{x:parseInt(a.pageX-(b.left+window.pageXOffset),10),y:parseInt(a.pageY-(b.top+window.pageYOffset),10)}}function c(a,b){return{x:a/I,y:b/I}}function b(a,b){a=parseInt(a,10);b=parseInt(b,10);K.style.width=a+"px";K.style.height=b+"px";w.width=a;A.width=a;B.width=a;x.width=a;y.width=a;w.height=b;A.height=b;B.height=b;x.height=b;y.height=b;M=a;N=b;if(null!=P){L.fillStyle="rgb(255, 255, 255)";L.fillRect(0,0,M,N);L.drawImage(H,
0,0,M,N);if(null!=F&&void 0!=F.onRedraw)F.onRedraw();if(null!=z&&void 0!=z.onRedraw)z.onRedraw()}}function d(){A.width=A.width;B.width=B.width;x.width=x.width;y.width=y.width;E.width=E.width}function e(){if(null!=F&&void 0!=F.onRemove)F.onRemove();F=null}function f(){var a=wpd.layoutManager.getGraphicsViewportSize();a.width/(1*a.height)>Q?(I=a.height/(1*C),b(a.height*Q,a.height)):(I=a.width/(1*D),b(a.width,a.width/Q))}function g(a){I=a;b(D*I,C*I)}function h(){R=!R;var a=document.getElementById("extended-crosshair-btn");
R?a.classList.add("pressed-button"):a.classList.remove("pressed-button");x.width=x.width}function k(a,b){var c=wpd.zoomView.getSize(),d=wpd.zoomView.getZoomRatio(),e=0,f=0,g=c.width,h=c.height;var k=c.width/d;c=c.height/d;var l=a-k/2;var n=b-c/2;a=l;b=n;var m=l+k;var p=n+c;0>l&&(a=0,e=-l*d);0>n&&(b=0,f=-n*d);l+k>=D&&(m=D,g-=d*(D-(l+k)));n+c>=C&&(p=C,h-=d*(C-(n+c)));k=O.getImageData(parseInt(a,10),parseInt(b,10),parseInt(m-a,10),parseInt(p-b,10));c=S.getImageData(parseInt(a,10),parseInt(b,10),parseInt(m-
a,10),parseInt(p-b,10));for(m=0;m<c.data.length;m+=4)if(0!=c.data[m]||0!=c.data[m+1]||0!=c.data[m+2])l=c.data[m+3]/255,k.data[m]=(1-l)*k.data[m]+l*c.data[m],k.data[m+1]=(1-l)*k.data[m+1]+l*c.data[m+1],k.data[m+2]=(1-l)*k.data[m+2]+l*c.data[m+2];a=d*(parseInt(a,10)-a);d*=parseInt(b,10)-b;wpd.zoomView.setZoomImage(k,parseInt(e+a,10),parseInt(f+d,10),parseInt(g-e,10),parseInt(h-f,10))}function l(b){clearTimeout(W);var d=setTimeout,e=a(b);b=e.x;var e=e.y,f=c(b,e);R&&(x.width=x.width,J.strokeStyle="rgba(0,0,0, 0.5)",
J.beginPath(),J.moveTo(b,0),J.lineTo(b,N),J.moveTo(0,e),J.lineTo(M,e),J.stroke());k(f.x,f.y);wpd.zoomView.setCoords(f.x,f.y);W=d(void 0,10)}function n(){w=document.getElementById("mainCanvas");A=document.getElementById("dataCanvas");B=document.getElementById("drawCanvas");x=document.getElementById("hoverCanvas");y=document.getElementById("topCanvas");H=document.createElement("canvas");E=document.createElement("canvas");L=w.getContext("2d");T=A.getContext("2d");J=x.getContext("2d");G=y.getContext("2d");
V=B.getContext("2d");O=H.getContext("2d");S=E.getContext("2d");K=document.getElementById("canvasDiv");document.addEventListener("keydown",function(a){U&&220===a.keyCode&&(a.preventDefault(),h())},!1);y.addEventListener("mousemove",l,!1);y.addEventListener("dragover",function(a){a.preventDefault()},!0);y.addEventListener("drop",function(a){a.preventDefault();wpd.busyNote.show();a=a.dataTransfer.files;1===a.length&&wpd.imageManager.loadFromFile(a[0])},!0);y.addEventListener("mousemove",p,!1);y.addEventListener("click",
q,!1);y.addEventListener("mouseup",u,!1);y.addEventListener("mousedown",v,!1);y.addEventListener("mouseout",t,!0);document.addEventListener("mouseup",r,!1);document.addEventListener("mousedown",function(a){U=a.target===y?!0:!1},!1);document.addEventListener("keydown",function(a){if(U&&null!=z&&void 0!=z.onKeyDown)z.onKeyDown(a)},!0);wpd.zoomView.initZoom();window.addEventListener("paste",function(a){if(void 0!==a.clipboardData&&(a=a.clipboardData.items,void 0!==a))for(var b=0;b<a.length;b++)if(-1!==
a[b].type.indexOf("image")){wpd.busyNote.show();var c=a[b].getAsFile();wpd.imageManager.loadFromFile(c)}},!1)}function m(){if(null!=z&&void 0!=z.onRemove)z.onRemove();z=null}function p(b){if(null!=z&&void 0!=z.onMouseMove){var d=a(b),e=c(d.x,d.y);z.onMouseMove(b,d,e)}}function q(b){if(null!=z&&void 0!=z.onMouseClick){var d=a(b),e=c(d.x,d.y);z.onMouseClick(b,d,e)}}function r(b){if(null!=z&&void 0!=z.onDocumentMouseUp){var d=a(b),e=c(d.x,d.y);z.onDocumentMouseUp(b,d,e)}}function u(b){if(null!=z&&void 0!=
z.onMouseUp){var d=a(b),e=c(d.x,d.y);z.onMouseUp(b,d,e)}}function v(b){if(null!=z&&void 0!=z.onMouseDown){var d=a(b),e=c(d.x,d.y);z.onMouseDown(b,d,e)}}function t(b){if(null!=z&&void 0!=z.onMouseOut){var d=a(b),e=c(d.x,d.y);z.onMouseOut(b,d,e)}}var w,A,B,x,y,H,E,K,L,T,V,J,G,O,S,M,N,D,C,Q,P,I,R=!1,W,z,F,U=!1;return{zoomIn:function(){g(1.2*I)},zoomOut:function(){g(I/1.2)},zoomFit:f,zoom100perc:function(){g(1)},toggleExtendedCrosshairBtn:h,setZoomRatio:g,getZoomRatio:function(){return I},runImageOp:function(a){var b=
a(P,D,C);a=b.imageData;var c=b.width,h=b.height,b=b.keepZoom;m();e();D=c;C=h;Q=D/(1*C);H.width=D;H.height=C;E.width=D;E.height=C;O.putImageData(a,0,0);P=a;w.width=w.width;d();b?g(I):f()},setTool:function(a){if(null!=z&&void 0!=z.onRemove)z.onRemove();z=a;if(null!=z&&void 0!=z.onAttach)z.onAttach()},removeTool:m,getAllContexts:function(){return{mainCtx:L,dataCtx:T,drawCtx:V,hoverCtx:J,topCtx:G,oriImageCtx:O,oriDataCtx:S}},resetData:function(){E.width=E.width;A.width=A.width},resetHover:function(){x.width=
x.width},imagePx:c,screenPx:function(a,b){return{x:a*I,y:b*I}},updateZoomOnEvent:function(b){b=a(b);b=c(b.x,b.y);k(b.x,b.y);wpd.zoomView.setCoords(b.x,b.y)},updateZoomToImagePosn:function(a,b){k(a,b);wpd.zoomView.setCoords(a,b)},getDisplaySize:function(){return{width:M,height:N}},getImageSize:function(){return{width:D,height:C}},copyImageDataLayerToScreen:function(){T.drawImage(E,0,0,M,N)},setRepainter:function(a){if(null!=F&&void 0!=F.onRemove)F.onRemove();F=a;if(null!=F&&void 0!=F.onAttach)F.onAttach()},
removeRepainter:e,forceHandlerRepaint:function(){if(null!=F&&void 0!=F.onForcedRedraw)F.onForcedRedraw()},getRepainter:function(){return F},saveImage:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),c;a.width=D;a.height=C;b.drawImage(H,0,0,D,C);var d=b.getImageData(0,0,D,C);var e=S.getImageData(0,0,D,C);for(c=0;c<d.data.length;c+=4)if(0!=e.data[c]||0!=e.data[c+1]||0!=e.data[c+2]){var f=e.data[c+3]/255;d.data[c]=(1-f)*d.data[c]+f*e.data[c];d.data[c+1]=(1-f)*d.data[c+1]+f*e.data[c+
1];d.data[c+2]=(1-f)*d.data[c+2]+f*e.data[c+2]}b.putImageData(d,0,0);window.open(a.toDataURL(),"_blank")},loadImage:function(a){null==w&&n();m();e();D=a.width;C=a.height;Q=D/(1*C);H.width=D;H.height=C;E.width=D;E.height=C;O.drawImage(a,0,0,D,C);P=O.getImageData(0,0,D,C);w.width=w.width;d();f();return P},getImagePNG:function(){for(var a=H.toDataURL("image/png"),a=atob(a.split(",")[1]),b=a.length,c=new Uint8Array(b);b--;)c[b]=a.charCodeAt(b);return imageFile=new Blob([c],{type:"image/png",encoding:"utf-8"})}}}();
wpd=wpd||{};
wpd.layoutManager=function(){function a(){var a=parseInt(document.body.offsetWidth,10),b=parseInt(document.body.offsetHeight,10);e.style.height=b+"px";f.style.height=b-280+"px";g.style.width=a-e.offsetWidth-5+"px";g.style.height=b+"px";d.style.height=b-45+"px";h.style.height=b-45+"px";wpd.sidebar.resize()}function c(c){clearTimeout(b);b=setTimeout(a,80)}var b,d,e,f,g,h;return{initialLayout:function(){d=document.getElementById("graphicsContainer");e=document.getElementById("sidebarContainer");f=document.getElementById("sidebarControlsContainer");
g=document.getElementById("mainContainer");h=document.getElementById("left-side-container");a();window.addEventListener("resize",c,!1);wpd.tree.init()},getGraphicsViewportSize:function(){return{width:d.offsetWidth,height:d.offsetHeight}}}}();wpd=wpd||{};
wpd.popup=function(){function a(a){var d=document.createElement("div");d.className="popup-drag-mask";d.style.display="inline-block";d.addEventListener("mousemove",c,!1);d.addEventListener("mouseup",b,!1);d.addEventListener("mouseout",e,!1);document.body.appendChild(d);g={dragMaskDiv:d,initialMouseX:a.pageX,initialMouseY:a.pageY,initialWindowX:h.offsetLeft,initialWindowY:h.offsetTop};a.preventDefault();a.stopPropagation()}function c(a){d(a);a.stopPropagation();a.preventDefault()}function b(a){d(a);
f();a.stopPropagation();a.preventDefault()}function d(a){var b=g.initialWindowX+a.pageX-g.initialMouseX;a=g.initialWindowY+a.pageY-g.initialMouseY;var c=parseInt(document.body.offsetWidth,10),d=parseInt(document.body.offsetHeight,10),e=parseInt(h.offsetWidth,10),f=parseInt(h.offsetHeight,10);b+.7*e<c&&0<b&&0<a&&a+.5*f<d&&(h.style.top=a+"px",h.style.left=b+"px")}function e(a){f()}function f(){null!=g&&null!=g.dragMaskDiv&&(g.dragMaskDiv.removeEventListener("mouseout",e,!1),g.dragMaskDiv.removeEventListener("mouseup",
b,!1),g.dragMaskDiv.removeEventListener("mousemove",c,!1),g.dragMaskDiv.style.display="none",document.body.removeChild(g.dragMaskDiv),g=null)}var g=null,h=null;return{show:function(b){document.getElementById("shadow").style.visibility="visible";b=document.getElementById(b);var c=parseInt(window.innerWidth,10),d=parseInt(window.innerHeight,10),e=parseInt(b.offsetWidth,10),f=parseInt(b.offsetHeight,10),d=(d-f)/2;b.style.left=(c-e)/2+"px";b.style.top=(60<d?60:d)+"px";b.style.visibility="visible";for(c=
0;c<b.childNodes.length;c++)if("popupheading"===b.childNodes[c].className){b.childNodes[c].addEventListener("mousedown",a,!1);break}h=b},close:function(a){document.getElementById("shadow").style.visibility="hidden";document.getElementById(a).style.visibility="hidden";f();h=null}}}();
wpd.busyNote=function(){var a,c=!1;return{show:function(){c||(null==a&&(a=document.createElement("div"),a.id="wait",a.innerHTML='<p align="center">'+wpd.gettext("processing")+"...</p>"),document.body.appendChild(a),c=!0)},close:function(){null!=a&&!0===c&&(document.body.removeChild(a),c=!1)}}}();
wpd.messagePopup=function(){var a;return{show:function(c,b,d){wpd.popup.show("messagePopup");document.getElementById("message-popup-heading").innerHTML=c;document.getElementById("message-popup-text").innerHTML=b;a=d},close:function(){wpd.popup.close("messagePopup");null!=a&&a()}}}();
wpd.okCancelPopup=function(){var a,c;return{show:function(b,d,e,f){wpd.popup.show("okCancelPopup");document.getElementById("ok-cancel-popup-heading").innerHTML=b;document.getElementById("ok-cancel-popup-text").innerHTML=d;a=e;c=f},ok:function(){wpd.popup.close("okCancelPopup");a()},cancel:function(){wpd.popup.close("okCancelPopup");c()}}}();wpd.unsupported=function(){wpd.messagePopup.show(wpd.gettext("unsupported"),wpd.gettext("unsupported-text"))};wpd=wpd||{};
wpd.sidebar=function(){function a(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)a[b].style.display="none"}return{show:function(c){a();c=document.getElementById(c);c.style.display="inline-block";c.style.height=parseInt(document.body.offsetHeight,10)-280+"px"},clear:a,resize:function(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)"inline-block"===a[b].style.display&&(a[b].style.height=parseInt(document.body.offsetHeight,10)-280+"px")}}}();
wpd=wpd||{};wpd.toolbar=function(){function a(){var a=document.getElementsByClassName("toolbar"),b;for(b=0;b<a.length;b++)a[b].style.visibility="hidden"}return{show:function(c){a();document.getElementById(c).style.visibility="visible"},clear:a}}();wpd=wpd||{};
wpd.transformationEquations=function(){return{show:function(){wpd.popup.show("axes-transformation-equations-window");var a=document.getElementById("axes-transformation-equation-list"),c="",b=wpd.tree.getActiveAxes(),d=b.getTransformationEquations(),c=c+"<p><b>Axes Type</b>: ";b instanceof wpd.XYAxes?c+="XY</p>":b instanceof wpd.PolarAxes?c+="Polar</p>":b instanceof wpd.TernaryAxes?c+="Ternary</p>":b instanceof wpd.MapAxes?c+="Map</p>":b instanceof wpd.ImageAxes&&(c+="Image</p>");if(null!=d.pixelToData){c+=
"<p><b>Pixel to Data</b></p><ol>";for(b=0;b<d.pixelToData.length;b++)c+='<li><p class="footnote">'+d.pixelToData[b]+"</p></li>";c+="</ol>"}c+="<p>&nbsp;</p>";if(null!=d.dataToPixel){c+="<p><b>Data to Pixel</b></p><ol>";for(b=0;b<d.dataToPixel.length;b++)c+='<li><p class="footnote">'+d.dataToPixel[b]+"</p></li>";c+="</ol>"}a.innerHTML=c}}}();wpd=wpd||{};
wpd.TreeWidget=function(a){var c=this;this.$mainElem=a;this.treeData=null;this.$mainElem.addEventListener("click",function(a){return c._onclick(a)});this.$mainElem.addEventListener("keydown",function(a){return c._onkeydown(a)});this.$mainElem.addEventListener("dblclick",function(a){return c._ondblclick(a)});this.idmap=[];this.itemCount=0;this.selectedPath=null};
wpd.TreeWidget.prototype._renderFolder=function(a,c,b){if(null!=a){b=b?'<ul class="tree-list">':'<ul class="tree-list-root">';for(var d=0;d<a.length;d++){var e=a[d];this.itemCount++;if("string"===typeof e)b+='<li title="'+e+'">',b+='<span class="tree-item" id="tree-item-id-'+this.itemCount+'">'+e+"</span>",this.idmap[this.itemCount]=c+"/"+e;else if("object"===typeof e){b+="<li>";var f=Object.keys(e)[0];b+='<span class="tree-folder" id="tree-item-id-'+this.itemCount+'">'+f+"</span>";this.idmap[this.itemCount]=
c+"/"+f;b+=this._renderFolder(e[f],c+"/"+f,!0)}b+="</li>"}return b+"</ul>"}};wpd.TreeWidget.prototype.render=function(a){this.idmap=[];this.itemCount=0;this.treeData=a;this.$mainElem.innerHTML=this._renderFolder(this.treeData,"",!1);this.selectedPath=null};
wpd.TreeWidget.prototype._unselectAll=function(){var a=this.$mainElem.querySelectorAll(".tree-folder"),c=this.$mainElem.querySelectorAll(".tree-item");a.forEach(function(a){a.classList.remove("tree-selected")});c.forEach(function(a){a.classList.remove("tree-selected")});this.selectedPath=null};
wpd.TreeWidget.prototype.selectPath=function(a,c){var b=this.idmap.indexOf(a);0<=b&&(this._unselectAll(),this.selectedPath=a,b=document.getElementById("tree-item-id-"+b),b.classList.add("tree-selected"),null!=this.itemSelectionCallback&&this.itemSelectionCallback(b,a,c))};
wpd.TreeWidget.prototype._onclick=function(a){var c=a.target.classList.contains("tree-item"),b=a.target.classList.contains("tree-folder");if(c||b)this._unselectAll(),a.target.classList.add("tree-selected"),null!=this.itemSelectionCallback&&(c=parseInt(a.target.id.replace("tree-item-id-",""),10),isNaN(c)||(this.selectedPath=this.idmap[c],this.itemSelectionCallback(a.target,this.idmap[c],!1)))};
wpd.TreeWidget.prototype._onkeydown=function(a){("F2"===a.key||"r"===a.key.toLowerCase()&&a.metaKey)&&this.itemRenameCallback&&(this.itemRenameCallback(a.target,this.selectedPath,!1),a.preventDefault())};wpd.TreeWidget.prototype._ondblclick=function(a){this.itemRenameCallback&&(this.itemRenameCallback(a.target,this.selectedPath,!1),a.preventDefault(),a.stopPropagation())};wpd.TreeWidget.prototype.onItemSelection=function(a){this.itemSelectionCallback=a};
wpd.TreeWidget.prototype.onItemRename=function(a){this.itemRenameCallback=a};wpd.TreeWidget.prototype.getSelectedPath=function(){return this.selectedPath};
wpd.tree=function(){function a(){if(null!=g){var a=[],b=wpd.appData.getPlotData(),d={};d[wpd.gettext("axes")]=b.getAxesNames();a.push(d);var d=b.getDatasetNames(),e={};e[wpd.gettext("datasets")]=d;a.push(e);var d=[],e=b.getMeasurementsByType(wpd.DistanceMeasurement),f=b.getMeasurementsByType(wpd.AngleMeasurement);0<b.getMeasurementsByType(wpd.AreaMeasurement).length&&d.push(wpd.gettext("area"));0<f.length&&d.push(wpd.gettext("angle"));0<e.length&&d.push(wpd.gettext("distance"));b={};b[wpd.gettext("measurements")]=
d;a.push(b);g.render(a);c(null)}}function c(a){document.querySelectorAll(".tree-widget").forEach(function(b){b.style.display=b.id===a?"inline":"none"})}function b(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.sidebar.clear()}function d(a){a=a==wpd.measurementModes.distance;var b=wpd.appData.getPlotData(),c=a?b.getMeasurementsByType(wpd.DistanceMeasurement):b.getMeasurementsByType(wpd.AreaMeasurement);if(1==c.length){var d=c[0];a=a?document.getElementById("distance-item-axes-select"):
document.getElementById("area-item-axes-select");for(var c=b.getAxesColl(),b=b.getAxesForMeasurement(d),d="<option value='-1'>None</option>",e=0;e<c.length;e++)if(c[e]instanceof wpd.ImageAxes||c[e]instanceof wpd.MapAxes)d+="<option value='"+e+"'>"+c[e].name+"</option>";a.innerHTML=d;a.value=null==b?"-1":c.indexOf(b);k=b}}function e(a,e,f){if(e==="/"+wpd.gettext("datasets"))b(),c("dataset-group-tree-widget"),k=null;else if(e==="/"+wpd.gettext("axes"))b(),c("axes-group-tree-widget"),k=null;else if(e===
"/"+wpd.gettext("measurements"))b(),c("measurement-group-tree-widget"),k=null;else if(e==="/"+wpd.gettext("measurements")+"/"+wpd.gettext("distance"))f||wpd.measurement.start(wpd.measurementModes.distance),c("distance-item-tree-widget"),d(wpd.measurementModes.distance);else if(e==="/"+wpd.gettext("measurements")+"/"+wpd.gettext("angle"))f||wpd.measurement.start(wpd.measurementModes.angle),c("angle-item-tree-widget"),k=null;else if(e==="/"+wpd.gettext("measurements")+"/"+wpd.gettext("area"))f||wpd.measurement.start(wpd.measurementModes.area),
c("area-item-tree-widget"),d(wpd.measurementModes.area);else if(e.startsWith("/"+wpd.gettext("datasets")+"/")){if(a=wpd.appData.getPlotData(),e=a.getDatasetNames().indexOf(e.replace("/"+wpd.gettext("datasets")+"/","")),0<=e&&(h=a.getDatasets()[e],f||(b(),wpd.acquireData.load())),c("dataset-item-tree-widget"),null!=h){e=wpd.appData.getPlotData();f=e.getAxesNames();e=e.getAxesForDataset(h);a=document.getElementById("dataset-item-axes-select");for(var g="<option value='-1'>None</option>",l=0;l<f.length;l++)g+=
"<option value='"+l+"'>"+f[l]+"</option>";a.innerHTML=g;a.value=null==e?"-1":f.indexOf(e.name);k=e}}else e.startsWith("/"+wpd.gettext("axes")+"/")?(b(),c("axes-item-tree-widget"),e=e.replace("/"+wpd.gettext("axes")+"/",""),f=wpd.appData.getPlotData(),e=f.getAxesNames().indexOf(e),k=f.getAxesColl()[e],document.getElementById("tweak-axes-calibration-button").disabled=k instanceof wpd.ImageAxes?!0:!1):(b(),c(null),k=null)}function f(a,b,c){b.startsWith("/"+wpd.gettext("datasets")+"/")?wpd.dataSeriesManagement.showRenameDataset():
b.startsWith("/"+wpd.gettext("axes")+"/")&&wpd.alignAxes.showRenameAxes()}var g=null,h=null,k=null;window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(a,b){b=b||window;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)});return{init:function(){var b=document.getElementById("tree-container");g=new wpd.TreeWidget(b);g.onItemSelection(e);g.onItemRename(f);a()},refresh:function(){a()},refreshPreservingSelection:function(b){if(null!=g){var c=g.getSelectedPath();a();g.selectPath(c,
!b)}else a()},selectPath:function(a,b){g.selectPath(a,b)},addMeasurement:function(b){wpd.measurement.start(b);a();b===wpd.measurementModes.distance?wpd.tree.selectPath("/"+wpd.gettext("measurements")+"/"+wpd.gettext("distance"),!0):b===wpd.measurementModes.angle?wpd.tree.selectPath("/"+wpd.gettext("measurements")+"/"+wpd.gettext("angle"),!0):b===wpd.measurementModes.area&&wpd.tree.selectPath("/"+wpd.gettext("measurements")+"/"+wpd.gettext("area"),!0)},getActiveDataset:function(){return h},getActiveAxes:function(){return k}}}();
wpd=wpd||{};
wpd.webcamCapture=function(){function a(){void 0!=c&&c.stop();wpd.popup.close("webcamCapture")}var c;return{start:function(){if(null==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia))wpd.messagePopup.show(wpd.gettext("webcam-capture"),wpd.gettext("webcam-capture-text"));else{wpd.popup.show("webcamCapture");var a=document.getElementById("webcamVideo");navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||
navigator.msGetUserMedia;navigator.getUserMedia({video:!0},function(b){c=b;a.src=window.URL.createObjectURL(b)},function(){})}},cancel:function(){a()},capture:function(){var b=document.createElement("canvas"),c=document.getElementById("webcamVideo"),e=b.getContext("2d");b.width=c.videoWidth;b.height=c.videoHeight;e.drawImage(c,0,0);var f=e.getImageData(0,0,b.width,b.height);a();wpd.graphicsWidget.runImageOp(function(){return{imageData:f,width:b.width,height:b.height}})}}}();wpd=wpd||{};
wpd.zoomView=function(){function a(){var a=document.getElementById("zoomCrossHair"),b=a.getContext("2d");a.width=a.width;b.strokeStyle="black"===h?"rgba(0,0,0,1)":"red"===h?"rgba(255,0,0,1)":"yellow"===h?"rgba(255,255,0,1)":"rgba(0,0,0,1)";b.beginPath();b.moveTo(125,0);b.lineTo(125,250);b.moveTo(0,125);b.lineTo(250,125);b.stroke()}var c,b,d,e,f,g,h="black";return{initZoom:function(){c=document.getElementById("zoomCanvas");b=c.getContext("2d");d=document.createElement("canvas");e=d.getContext("2d");
f=document.getElementById("mousePosition");g=5;a()},setZoomImage:function(a,f,h,m,p){d.width=m/g;d.height=p/g;e.putImageData(a,0,0);c.width=c.width;b.drawImage(d,f,h,m,p)},setCoords:function(a,b){var c=wpd.tree.getActiveAxes();f.innerHTML=null!=c?c.pixelToLiveString(a,b):a.toFixed(2)+", "+b.toFixed(2)},setZoomRatio:function(a){g=a},getZoomRatio:function(){return g},getSize:function(){return{width:250,height:250}},showSettingsWindow:function(){document.getElementById("zoom-magnification-value").value=
g;document.getElementById("zoom-crosshair-color-value").value=h;wpd.popup.show("zoom-settings-popup")},applySettings:function(){g=document.getElementById("zoom-magnification-value").value;h=document.getElementById("zoom-crosshair-color-value").value;a();wpd.popup.close("zoom-settings-popup")}}}();wpd=wpd||{};
wpd.AxesCornersTool=function(){return function(a,c){var b=0,d=!0;c?(b=a.maxPointCount,d=!1):(b=0,d=!0,wpd.graphicsWidget.resetData());this.onMouseClick=function(c,f,g){d?(b+=1,a.addPoint(g.x,g.y,0,0),a.unselectAll(),a.selectPoint(b-1),wpd.graphicsWidget.forceHandlerRepaint(),b===a.maxPointCount&&(d=!1,wpd.alignAxes.calibrationCompleted())):(a.unselectAll(),a.selectNearestPoint(g.x,g.y),wpd.graphicsWidget.forceHandlerRepaint());wpd.graphicsWidget.updateZoomOnEvent(c)};this.onKeyDown=function(b){if(0!==
a.getSelectedPoints().length){var c=a.getPoint(a.getSelectedPoints()[0]),d=c.px,c=c.py,e=!0===b.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(b.keyCode))c-=e;else if(wpd.keyCodes.isDown(b.keyCode))c+=e;else if(wpd.keyCodes.isLeft(b.keyCode))d-=e;else if(wpd.keyCodes.isRight(b.keyCode))d+=e;else return;a.changePointPx(a.getSelectedPoints()[0],d,c);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(d,c);b.preventDefault();
b.stopPropagation()}}}}();wpd.AlignmentCornersRepainter=function(){return function(a){this.painterName="AlignmentCornersReptainer";this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()};this.onRedraw=function(){if(null!=a){var c;for(c=0;c<a.getCount();c++){var b=a.getPoint(c);b={x:b.px,y:b.py};var d=a.isPointSelected(c)?"rgba(0,200,0,1)":"rgba(200,0,0,1)";wpd.graphicsHelper.drawPoint(b,d,a.labels[c],a.labelPositions[c])}}}}}();wpd=wpd||{};
wpd.ColorPickerTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts();this.onMouseClick=function(c,b,d){var e=a.oriImageCtx.getImageData(d.x,d.y,1,1);c=e.data[0];b=e.data[1];d=e.data[2];0===e.data[3]&&(d=b=c=255);this.onComplete([c,b,d])};this.onComplete=function(a){}}}();
wpd.ColorFilterRepainter=function(){return function(){this.painterName="colorFilterRepainter";this.onRedraw=function(){var a=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(a.binaryData,a.mask)}}}();wpd=wpd||{};
wpd.graphicsHelper=function(){return{drawPoint:function(a,c,b,d){var e=wpd.graphicsWidget.screenPx(a.x,a.y),f=wpd.graphicsWidget.getAllContexts(),g=wpd.graphicsWidget.getImageSize().height;if(null!=b){f.dataCtx.font="15px sans-serif";var h=f.dataCtx.measureText(b).width;f.dataCtx.fillStyle="rgba(255, 255, 255, 0.7)";f.oriDataCtx.font="15px sans-serif";f.oriDataCtx.fillStyle=c;switch(d){case "N":case "n":f.dataCtx.fillRect(e.x-13,e.y-24,h+5,35);f.dataCtx.fillStyle=c;f.dataCtx.fillText(b,e.x-10,e.y-
7);f.oriDataCtx.fillText(b,a.x-10,a.y-7);break;case "E":case "e":f.dataCtx.fillRect(e.x-7,e.y-16,h+17,26);f.dataCtx.fillStyle=c;f.dataCtx.fillText(b,e.x+7,e.y+5);f.oriDataCtx.fillText(b,a.x+7,a.y+5);break;case "W":case "w":f.dataCtx.fillRect(e.x-h-10,e.y-16,h+17,26);f.dataCtx.fillStyle=c;f.dataCtx.fillText(b,e.x-h-7,e.y+5);f.oriDataCtx.fillText(b,a.x-h-7,a.y+5);break;default:f.dataCtx.fillRect(e.x-13,e.y-8,h+5,35),f.dataCtx.fillStyle=c,f.dataCtx.fillText(b,e.x-10,e.y+18),f.oriDataCtx.fillText(b,a.x-
10,a.y+18)}}f.dataCtx.beginPath();f.dataCtx.fillStyle=c;f.dataCtx.strokeStyle="rgb(255, 255, 255)";f.dataCtx.arc(e.x,e.y,4,0,2*Math.PI,!0);f.dataCtx.fill();f.dataCtx.stroke();f.oriDataCtx.beginPath();f.oriDataCtx.fillStyle=c;f.oriDataCtx.strokeStyle="rgb(255, 255, 255)";f.oriDataCtx.arc(a.x,a.y,1500<g?4:2,0,2*Math.PI,!0);f.oriDataCtx.fill();f.oriDataCtx.stroke()}}}();wpd=wpd||{};
wpd.GridColorFilterRepainter=function(){return function(){this.painterName="gridColorFilterRepainter";this.onRedraw=function(){var a=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(a.gridBinaryData,a.gridMask.pixels)}}}();
wpd.GridBoxTool=function(){return function(){var a=!1,c,b,d=wpd.graphicsWidget.getAllContexts(),e,f,g=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(b.x,b.y,f.x-b.x,f.y-b.y)},h=function(f,g,h){!1!==a&&(clearTimeout(e),a=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,0.8)",d.dataCtx.fillRect(b.x,b.y,g.x-b.x,g.y-b.y),d.oriDataCtx.fillStyle="rgba(255,255,0,0.8)",d.oriDataCtx.fillRect(c.x,c.y,h.x-c.x,h.y-c.y))},k=null,l=null;
this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-box").classList.add("pressed-button");document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==a&&(a=!0,c=f,b=e)};this.onMouseMove=function(b,c,d){!1!==a&&(f=c,clearTimeout(e),e=setTimeout(g,2))};this.onMouseOut=function(b,c,d){!0===a&&(clearTimeout(e),k=c,l=d)};this.onDocumentMouseUp=function(a,b,c){null!=k&&null!=l?h(a,k,l):
h(a,b,c);l=k=null};this.onMouseUp=function(a,b,c){h(a,b,c)};this.onRemove=function(){document.getElementById("grid-mask-box").classList.remove("pressed-button");document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridMaskPainter=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=wpd.appData.getPlotData().getAutoDetector(),b=function(){if(null!=c.gridMask.pixels&&0!==c.gridMask.pixels.length){var b=wpd.graphicsWidget.getImageSize();imgData=a.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<c.gridMask.pixels.length;b++){var e=c.gridMask.pixels[b];imgData.data[4*e]=255;imgData.data[4*e+1]=255;imgData.data[4*e+2]=0;imgData.data[4*e+3]=200}a.oriDataCtx.putImageData(imgData,0,0);
wpd.graphicsWidget.copyImageDataLayerToScreen()}};this.painterName="gridMaskPainter";this.onRedraw=function(){wpd.gridDetection.grabMask();b()};this.onAttach=function(){wpd.graphicsWidget.resetData();b()}}}();wpd=wpd||{};
wpd.imageOps=function(){function a(a,c,e){var b,d,h;for(b=0;b<e;b++)for(d=0;d<c/2;d++){var k=4*(b*c+d);var l=4*((b+1)*c-(d+1));for(h=0;4>h;h++){var n=a.data[k+h];a.data[k+h]=a.data[l+h];a.data[l+h]=n}}return{imageData:a,width:c,height:e}}function c(a,c,e){var b,d,h;for(b=0;b<e/2;b++)for(d=0;d<c;d++){var k=4*(b*c+d);var l=4*((e-(b+2))*c+d);for(h=0;4>h;h++){var n=a.data[k+h];a.data[k+h]=a.data[l+h];a.data[l+h]=n}}return{imageData:a,width:c,height:e}}return{hflip:function(){wpd.graphicsWidget.runImageOp(a)},
vflip:function(){wpd.graphicsWidget.runImageOp(c)}}}();wpd=wpd||{};wpd.keyCodes=function(){return{isUp:function(a){return 38===a},isDown:function(a){return 40===a},isLeft:function(a){return 37===a},isRight:function(a){return 39===a},isTab:function(a){return 9===a},isDel:function(a){return 46===a},isBackspace:function(a){return 8===a},isAlphabet:function(a,c){return 90<a||65>a?!1:String.fromCharCode(a).toLowerCase()===c},isEnter:function(a){return 13===a},isEsc:function(a){return 27===a}}}();
wpd=wpd||{};
wpd.ManualSelectionTool=function(){return function(a,c){this.onAttach=function(){document.getElementById("manual-select-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter(a,c))};this.onMouseClick=function(b,d,e){a.dataPointsHaveLabels?(d=c.getMetadataKeys(),null!=d&&"Label"===d[0]||c.setMetadataKeys(["Label"]),d=a.dataPointsLabelPrefix+c.getCount(),c.addPixel(e.x,e.y,[d]),wpd.graphicsHelper.drawPoint(e,"rgb(200,0,0)",d)):(c.addPixel(e.x,e.y),wpd.graphicsHelper.drawPoint(e,
"rgb(200,0,0)"));wpd.graphicsWidget.updateZoomOnEvent(b);wpd.dataPointCounter.setCount(c.getCount());a.dataPointsHaveLabels&&b.shiftKey&&wpd.dataPointLabelEditor.show(c,c.getCount()-1,this)};this.onRemove=function(){document.getElementById("manual-select-button").classList.remove("pressed-button")};this.onKeyDown=function(a){var b=c.getCount()-1,e=c.getPixel(b),f=.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))e.y-=f;else if(wpd.keyCodes.isDown(a.keyCode))e.y+=f;else if(wpd.keyCodes.isLeft(a.keyCode))e.x-=
f;else if(wpd.keyCodes.isRight(a.keyCode))e.x+=f;else{wpd.acquireData.isToolSwitchKey(a.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase());return}c.setPixelAt(b,e.x,e.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e.x,e.y);a.preventDefault()}}}();
wpd.DeleteDataPointTool=function(){return function(a,c){wpd.graphicsWidget.getAllContexts();this.onAttach=function(){document.getElementById("delete-point-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter(a,c))};this.onMouseClick=function(a,d,e){c.removeNearestPixel(e.x,e.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a);wpd.dataPointCounter.setCount(c.getCount())};this.onKeyDown=function(a){wpd.acquireData.isToolSwitchKey(a.keyCode)&&
wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase())};this.onRemove=function(){document.getElementById("delete-point-button").classList.remove("pressed-button")}}}();
wpd.DataPointsRepainter=function(){return function(a,c){var b=function(){var b=c.getMetadataKeys();var e=!1;if(null!=a)for(a.dataPointsHaveLabels&&null!=b&&"Label"===b[0]&&(e=!0),b=0;b<c.getCount();b++){var f=c.getPixel(b);var g=(g=0<=c.getSelectedPixels().indexOf(b))?"rgb(0,200,0)":"rgb(200,0,0)";if(e){var h=f.metadata[0];null==h&&(h=a.dataPointsLabelPrefix+b);wpd.graphicsHelper.drawPoint(f,g,h)}else wpd.graphicsHelper.drawPoint(f,g)}};this.painterName="dataPointsRepainter";this.onAttach=function(){wpd.graphicsWidget.resetData();
b()};this.onRedraw=function(){b()};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();b()}}}();
wpd.AdjustDataPointTool=function(){return function(a,c){this.onAttach=function(){document.getElementById("manual-adjust-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter(a,c));wpd.toolbar.show("adjustDataPointsToolbar")};this.onRemove=function(){c.unselectAll();wpd.graphicsWidget.forceHandlerRepaint();document.getElementById("manual-adjust-button").classList.remove("pressed-button");wpd.toolbar.clear()};this.onMouseClick=function(a,d,e){c.unselectAll();
c.selectNearestPixel(e.x,e.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(b){if(wpd.acquireData.isToolSwitchKey(b.keyCode))wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(b.keyCode).toLowerCase());else{var d=c.getSelectedPixels()[0];if(null!=d){var e=c.getPixel(d),f=e.x,e=e.y,g=!0===b.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(b.keyCode))e-=g;else if(wpd.keyCodes.isDown(b.keyCode))e+=
g;else if(wpd.keyCodes.isLeft(b.keyCode))f-=g;else if(wpd.keyCodes.isRight(b.keyCode))f+=g;else if(wpd.keyCodes.isAlphabet(b.keyCode,"q"))c.selectPreviousPixel(),d=c.getSelectedPixels()[0],e=c.getPixel(d),f=e.x,e=e.y;else if(wpd.keyCodes.isAlphabet(b.keyCode,"w"))c.selectNextPixel(),d=c.getSelectedPixels()[0],e=c.getPixel(d),f=e.x,e=e.y;else if(wpd.keyCodes.isAlphabet(b.keyCode,"e")){if(a.dataPointsHaveLabels){d=c.getSelectedPixels()[0];b.preventDefault();b.stopPropagation();wpd.dataPointLabelEditor.show(c,
d,this);return}}else{if(wpd.keyCodes.isDel(b.keyCode)||wpd.keyCodes.isBackspace(b.keyCode))c.removePixelAtIndex(d),c.unselectAll(),0<=c.findNearestPixel(f,e)&&(c.selectNearestPixel(f,e),d=c.getSelectedPixels()[0],e=c.getPixel(d),f=e.x,e=e.y),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.updateZoomToImagePosn(f,e),wpd.dataPointCounter.setCount(),b.preventDefault(),b.stopPropagation();return}c.setPixelAt(d,f,e);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(f,
e);b.preventDefault();b.stopPropagation()}}}}}();
wpd.EditLabelsTool=function(a,c){this.onAttach=function(){document.getElementById("edit-data-labels").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter(a,c))};this.onRemove=function(){document.getElementById("edit-data-labels").classList.remove("pressed-button");c.unselectAll()};this.onMouseClick=function(a,d,e){c.unselectAll();d=c.selectNearestPixel(e.x,e.y);0<=d&&(wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.updateZoomOnEvent(a),wpd.dataPointLabelEditor.show(c,
d,this))};this.onKeyDown=function(a){wpd.acquireData.isToolSwitchKey(a.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase())}};wpd.dataPointCounter={setCount:function(a){for(var c=document.getElementsByClassName("data-point-counter"),b=0;b<c.length;b++)c[b].innerHTML=a}};wpd=wpd||{};
wpd.BoxMaskTool=function(){return function(){var a=!1,c,b,d=wpd.graphicsWidget.getAllContexts(),e,f,g=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(b.x,b.y,f.x-b.x,f.y-b.y)},h=function(f,g,h){!1!==a&&(clearTimeout(e),a=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,1)",d.dataCtx.fillRect(b.x,b.y,g.x-b.x,g.y-b.y),d.oriDataCtx.fillStyle="rgba(255,255,0,1)",d.oriDataCtx.fillRect(c.x,c.y,h.x-c.x,h.y-c.y))},k=null,l=null;this.onAttach=
function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("box-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==a&&(a=!0,c=f,b=e)};this.onMouseMove=function(b,c,d){!1!==a&&(f=c,clearTimeout(e),e=setTimeout(g,2))};this.onMouseOut=function(b,c,d){!0===a&&(clearTimeout(e),k=c,l=d)};this.onDocumentMouseUp=function(a,b,c){null!=k&&null!=l?h(a,k,l):h(a,b,c);l=k=null};this.onMouseUp=
function(a,b,c){h(a,b,c)};this.onRemove=function(){document.getElementById("box-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.PenMaskTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=!1,b,d,e,f=function(){a.dataCtx.strokeStyle="rgba(255,255,0,1)";a.dataCtx.lineTo(d.x,d.y);a.dataCtx.stroke();a.oriDataCtx.strokeStyle="rgba(255,255,0,1)";a.oriDataCtx.lineTo(e.x,e.y);a.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("pen-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button");
wpd.toolbar.show("paintToolbar")};this.onMouseDown=function(b,d,e){!0!==c&&(b=parseInt(document.getElementById("paintThickness").value,10),c=!0,a.dataCtx.strokeStyle="rgba(255,255,0,1)",a.dataCtx.lineWidth=b*wpd.graphicsWidget.getZoomRatio(),a.dataCtx.beginPath(),a.dataCtx.moveTo(d.x,d.y),a.oriDataCtx.strokeStyle="rgba(255,255,0,1)",a.oriDataCtx.lineWidth=b,a.oriDataCtx.beginPath(),a.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(a,h,k){!1!==c&&(d=h,e=k,clearTimeout(b),b=setTimeout(f,2))};
this.onMouseUp=function(d,e,f){clearTimeout(b);a.dataCtx.closePath();a.dataCtx.lineWidth=1;a.oriDataCtx.closePath();a.oriDataCtx.lineWidth=1;c=!1};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onRemove=function(){document.getElementById("pen-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();
wpd.EraseMaskTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=!1,b,d,e,f=function(){a.dataCtx.globalCompositeOperation="destination-out";a.oriDataCtx.globalCompositeOperation="destination-out";a.dataCtx.strokeStyle="rgba(255,255,0,1)";a.dataCtx.lineTo(d.x,d.y);a.dataCtx.stroke();a.oriDataCtx.strokeStyle="rgba(255,255,0,1)";a.oriDataCtx.lineTo(e.x,e.y);a.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("erase-mask").classList.add("pressed-button");
document.getElementById("view-mask").classList.add("pressed-button");wpd.toolbar.show("eraseToolbar")};this.onMouseDown=function(b,d,e){!0!==c&&(b=parseInt(document.getElementById("eraseThickness").value,10),c=!0,a.dataCtx.globalCompositeOperation="destination-out",a.oriDataCtx.globalCompositeOperation="destination-out",a.dataCtx.strokeStyle="rgba(0,0,0,1)",a.dataCtx.lineWidth=b*wpd.graphicsWidget.getZoomRatio(),a.dataCtx.beginPath(),a.dataCtx.moveTo(d.x,d.y),a.oriDataCtx.strokeStyle="rgba(0,0,0,1)",
a.oriDataCtx.lineWidth=b,a.oriDataCtx.beginPath(),a.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(a,h,k){!1!==c&&(d=h,e=k,clearTimeout(b),b=setTimeout(f,2))};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onMouseUp=function(d,e,f){clearTimeout(b);a.dataCtx.closePath();a.dataCtx.lineWidth=1;a.oriDataCtx.closePath();a.oriDataCtx.lineWidth=1;a.dataCtx.globalCompositeOperation="source-over";a.oriDataCtx.globalCompositeOperation="source-over";c=!1};this.onRemove=function(){document.getElementById("erase-mask").classList.remove("pressed-button");
document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();wpd.ViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("view-mask").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.MaskPainter=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=wpd.appData.getPlotData().getAutoDetector(),b=function(){if(null!=c.mask&&0!==c.mask.length){var b=wpd.graphicsWidget.getImageSize();imgData=a.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<c.mask.length;b++){var e=c.mask[b];imgData.data[4*e]=255;imgData.data[4*e+1]=255;imgData.data[4*e+2]=0;imgData.data[4*e+3]=255}a.oriDataCtx.putImageData(imgData,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}};
this.painterName="dataMaskPainter";this.onRedraw=function(){wpd.dataMask.grabMask();b()};this.onAttach=function(){wpd.graphicsWidget.resetData();b()}}}();wpd=wpd||{};
wpd.AddMeasurementTool=function(){return function(a){var c=wpd.graphicsWidget.getAllContexts(),b=0,d=!0,e=[];this.onAttach=function(){document.getElementById(a.addButtonId).classList.add("pressed-button");0>a.connectivity&&(document.getElementById("add-polygon-info").style.display="block")};this.onRemove=function(){document.getElementById(a.addButtonId).classList.remove("pressed-button");0>a.connectivity&&(document.getElementById("add-polygon-info").style.display="none")};this.onKeyDown=function(b){wpd.keyCodes.isAlphabet(b.keyCode,
"a")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(a))):wpd.keyCodes.isAlphabet(b.keyCode,"d")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(a))):(wpd.keyCodes.isEnter(b.keyCode)||wpd.keyCodes.isEsc(b.keyCode))&&!0===d&&0>a.connectivity&&(d=!1,a.getData().addConnection(e),wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(a)))};this.onMouseClick=
function(f,g,h){if(d){wpd.graphicsWidget.resetHover();e[2*b]=h.x;e[2*b+1]=h.y;b+=1;if(b===a.connectivity){d=!1;a.getData().addConnection(e);wpd.graphicsWidget.resetHover();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(a));return}if(1<b){var k=wpd.graphicsWidget.screenPx(e[2*(b-2)],e[2*(b-2)+1]);c.dataCtx.beginPath();c.dataCtx.strokeStyle="rgb(0,0,10)";c.dataCtx.moveTo(k.x,k.y);c.dataCtx.lineTo(g.x,g.y);c.dataCtx.stroke();c.oriDataCtx.beginPath();
c.oriDataCtx.strokeStyle="rgb(0,0,10)";c.oriDataCtx.moveTo(e[2*(b-2)],e[2*(b-2)+1]);c.oriDataCtx.lineTo(h.x,h.y);c.oriDataCtx.stroke()}c.dataCtx.beginPath();c.dataCtx.fillStyle="rgb(200, 0, 0)";c.dataCtx.arc(g.x,g.y,3,0,2*Math.PI,!0);c.dataCtx.fill();c.oriDataCtx.beginPath();c.oriDataCtx.fillStyle="rgb(200,0,0)";c.oriDataCtx.arc(h.x,h.y,3,0,2*Math.PI,!0);c.oriDataCtx.fill()}wpd.graphicsWidget.updateZoomOnEvent(f)};this.onMouseMove=function(a,g,h){d&&1<=b&&(wpd.graphicsWidget.resetHover(),a=wpd.graphicsWidget.screenPx(e[2*
(b-1)],e[2*(b-1)+1]),c.hoverCtx.beginPath(),c.hoverCtx.strokeStyle="rgb(0,0,0)",c.hoverCtx.moveTo(a.x,a.y),c.hoverCtx.lineTo(g.x,g.y),c.hoverCtx.stroke())}}}();
wpd.DeleteMeasurementTool=function(){return function(a){wpd.graphicsWidget.getAllContexts();this.onAttach=function(){document.getElementById(a.deleteButtonId).classList.add("pressed-button")};this.onRemove=function(){document.getElementById(a.deleteButtonId).classList.remove("pressed-button")};this.onKeyDown=function(c){wpd.keyCodes.isAlphabet(c.keyCode,"a")?wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(a)):wpd.keyCodes.isAlphabet(c.keyCode,"d")&&wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(a))};
this.onMouseClick=function(c,b,d){a.getData().deleteNearestConnection(d.x,d.y);wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(a));wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c)}}}();
wpd.AdjustMeasurementTool=function(){return function(a){this.onAttach=function(){};this.onMouseClick=function(c,b,d){a.getData().selectNearestPoint(d.x,d.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c)};this.onKeyDown=function(c){if(wpd.keyCodes.isAlphabet(c.keyCode,"a"))wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(a));else if(wpd.keyCodes.isAlphabet(c.keyCode,"d"))wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(a));else{var b=a.getData(),d=b.getSelectedConnectionAndPoint();
if(0<=d.connectionIndex&&0<=d.pointIndex){var e=!0===c.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio(),f=b.getPointAt(d.connectionIndex,d.pointIndex);if(wpd.keyCodes.isUp(c.keyCode))f.y-=e;else if(wpd.keyCodes.isDown(c.keyCode))f.y+=e;else if(wpd.keyCodes.isLeft(c.keyCode))f.x-=e;else if(wpd.keyCodes.isRight(c.keyCode))f.x+=e;else return;b.setPointAt(d.connectionIndex,d.pointIndex,f.x,f.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(f.x,
f.y);c.preventDefault();c.stopPropagation()}}}}}();
wpd.MeasurementRepainter=function(){return function(a){var c=wpd.graphicsWidget.getAllContexts(),b=function(a,b,e,d,l,n,m,p){c.dataCtx.beginPath();c.dataCtx.strokeStyle="rgb(0,0,10)";c.dataCtx.moveTo(a,b);c.dataCtx.lineTo(e,d);c.dataCtx.stroke();c.oriDataCtx.beginPath();c.oriDataCtx.strokeStyle="rgb(0,0,10)";c.oriDataCtx.moveTo(l,n);c.oriDataCtx.lineTo(m,p);c.oriDataCtx.stroke()},d=function(a,b,e,d,l){c.dataCtx.beginPath();c.dataCtx.fillStyle=l?"rgb(0, 200, 0)":"rgb(200, 0, 0)";c.dataCtx.arc(a,b,
3,0,2*Math.PI,!0);c.dataCtx.fill();c.oriDataCtx.beginPath();c.oriDataCtx.fillStyle=l?"rgb(0,200,0)":"rgb(200,0,0)";c.oriDataCtx.arc(e,d,3,0,2*Math.PI,!0);c.oriDataCtx.fill()},e=function(a,b,e,d,l){a=parseInt(a,10);b=parseInt(b,10);e=parseInt(e,10);d=parseInt(d,10);c.dataCtx.font="14px sans-serif";var f=c.dataCtx.measureText(l).width;c.dataCtx.fillStyle="rgba(255, 255, 255, 0.7)";c.dataCtx.fillRect(a-5,b-15,f+10,25);c.dataCtx.fillStyle="rgb(200, 0, 0)";c.dataCtx.fillText(l,a,b);c.oriDataCtx.font="14px sans-serif";
f=c.oriDataCtx.measureText(l).width;c.oriDataCtx.fillStyle="rgba(255, 255, 255, 0.7)";c.oriDataCtx.fillRect(e-5,d-15,f+10,25);c.oriDataCtx.fillStyle="rgb(200, 0, 0)";c.oriDataCtx.fillText(l,e,d)};this.painterName="measurementRepainter-"+a.name;this.onAttach=function(){};this.onRedraw=function(){if(a.name===wpd.measurementModes.distance.name){var f=a.getData(),g=f.connectionCount(),h,k=a.getAxes();for(h=0;h<g;h++){var l=f.getConnectionAt(h);var n=l[0];var m=l[1];var p=l[2];l=l[3];var q=f.isPointSelected(h,
0);var r=f.isPointSelected(h,1);var u=!0===wpd.appData.isAligned()&&k instanceof wpd.MapAxes?"Dist"+h.toString()+": "+k.pixelToDataDistance(f.getDistance(h)).toFixed(2)+" "+k.getUnits():"Dist"+h.toString()+": "+f.getDistance(h).toFixed(2)+" px";var v=wpd.graphicsWidget.screenPx(n,m);var t=wpd.graphicsWidget.screenPx(p,l);b(v.x,v.y,t.x,t.y,n,m,p,l);d(v.x,v.y,n,m,q);d(t.x,t.y,p,l,r);e(.5*(v.x+t.x),.5*(v.y+t.y),.5*(n+p),.5*(m+l),u)}}else if(a.name===wpd.measurementModes.angle.name){var f=a.getData(),
g=f.connectionCount();for(h=0;h<g;h++){p=f.getConnectionAt(h);t=p[0];u=p[1];n=p[2];m=p[3];q=p[4];r=p[5];var w=f.isPointSelected(h,0);var A=f.isPointSelected(h,1);var B=f.isPointSelected(h,2);k="Theta"+h.toString()+": "+f.getAngle(h).toFixed(2)+"\u00b0";v=Math.atan2(u-m,t-n);l=Math.atan2(r-m,q-n);var x=wpd.graphicsWidget.screenPx(t,u);p=wpd.graphicsWidget.screenPx(n,m);var y=wpd.graphicsWidget.screenPx(q,r);b(x.x,x.y,p.x,p.y,t,u,n,m);b(p.x,p.y,y.x,y.y,n,m,q,r);d(x.x,x.y,t,u,w);d(p.x,p.y,n,m,A);d(y.x,
y.y,q,r,B);t=p.x;u=p.y;q=n;r=m;c.dataCtx.beginPath();c.dataCtx.strokeStyle="rgb(0,0,10)";c.dataCtx.arc(t,u,15,v,l,!0);c.dataCtx.stroke();c.oriDataCtx.beginPath();c.oriDataCtx.strokeStyle="rgb(0,0,10)";c.oriDataCtx.arc(q,r,15,v,l,!0);c.oriDataCtx.stroke();e(p.x+10,p.y+15,n+10,m+15,k)}}else if(a.name===wpd.measurementModes.area.name)for(f=a.getData(),g=f.connectionCount(),h=a.getAxes(),n=0;n<g;n++){k=f.getConnectionAt(n);r=q=p=m=0;x={x:0,y:0};for(l=0;l<k.length;l+=2)v=k[l],t=k[l+1],u=wpd.graphicsWidget.screenPx(v,
t),2<=l&&b(x.x,x.y,u.x,u.y,q,r,v,t),l==k.length-2&&(q=k[0],r=k[1],x=wpd.graphicsWidget.screenPx(q,r),b(x.x,x.y,u.x,u.y,q,r,v,t)),q=v,r=t,x=u;for(l=0;l<k.length;l+=2)v=k[l],t=k[l+1],u=wpd.graphicsWidget.screenPx(v,t),q=f.isPointSelected(n,l/2),d(u.x,u.y,v,t,q),m+=v,p+=t;m/=k.length/2;p/=k.length/2;k=wpd.graphicsWidget.screenPx(m,p);!0===wpd.appData.isAligned()&&h instanceof wpd.MapAxes?(l="Area"+n+": "+h.pixelToDataArea(f.getArea(n)).toFixed(2)+" "+h.getUnits()+"^2",v="Perimeter"+n+": "+h.pixelToDataDistance(f.getPerimeter(n)).toFixed(2)+
" "+h.getUnits()):(l="Area"+n+": "+f.getArea(n).toFixed(2)+" px^2",v="Perimeter"+n+": "+f.getPerimeter(n).toFixed(2)+" px");e(k.x,k.y,m,p,l+", "+v)}};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()}}}();wpd=wpd||{};wpd.args=function(){return{getValue:function(a){var c,b=window.location.search.substring(1).split("&");for(c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]===a)return unescape(d[1])}return null}}}();wpd=wpd||{};
wpd.dataExport=function(){return{show:function(){},generateCSV:function(){wpd.popup.close("export-all-data-popup");var a=wpd.appData.getPlotData(),c=a.getDatasets();if(null==c||0===c.length)wpd.messagePopup.show(wpd.gettext("no-datasets-to-export-error"),wpd.gettext("no-datasets-to-export"));else{for(var b=0,d=[],e=[],f=[],g=0,h=0;h<c.length;h++){var k=a.getAxesForDataset(c[h]);if(null!=k){var k=k.getAxesLabels(),l=k.length,g=g+l,n=c[h].getCount();n>b&&(b=n);d.push(c[h].name);for(n=0;n<l;n++)0!==
n&&d.push(""),e.push(k[n])}}for(h=0;h<b;h++){k=[];for(l=0;l<g;l++)k.push("");f.push(k)}for(h=g=0;h<c.length;h++)if(k=a.getAxesForDataset(c[h]),null!=k){for(var l=k.getAxesLabels().length,n=c[h].getCount(),m=0;m<n;m++){var p=c[h].getPixel(m),q=m;var r=k;var u=p,p=r.pixelToData(u.x,u.y);if(r instanceof wpd.XYAxes)for(q=0;1>=q;q++)r.isDate(q)&&(u=r.getInitialDateFormat(q),p[q]=wpd.dateConverter.formatDateNumber(p[q],u));else r instanceof wpd.BarAxes&&(p=["",p[0]],p[0]=null==u.metadata?"Bar"+q:u.metadata[0]);
r=p;for(p=0;p<l;p++)f[m][g+p]=r[p]}g+=l}a=d.join(",")+"\n"+e.join(",")+"\n";for(c=0;c<b;c++)a+=f[c].join(",")+"\n";wpd.download.csv(a,"wpd_datasets.csv")}},exportToPlotly:function(){wpd.popup.close("export-all-data-popup");var a=wpd.appData.getPlotData().getDatasets(),c,b,d,e=wpd.plotDataProvider,f={data:[]};if(null==a||0===a.length)wpd.messagePopup.show(wpd.gettext("no-datasets-to-export-error"),wpd.gettext("no-datasets-to-export"));else{for(c=0;c<a.length;c++){e.setDataSource(a[c]);var g=e.getData();
f.data[c]={};for(b=0;2>b;b++){var h=0===b?"x":"y";f.data[c][h]=[];for(d=0;d<g.rawData.length;d++)f.data[c][h][d]=null!=g.fieldDateFormat[b]?wpd.dateConverter.formatDateNumber(g.rawData[d][b],"yyyy-mm-dd hh:ii:ss"):g.rawData[d][b]}}wpd.plotly.send(f)}}}}();wpd=wpd||{};
wpd.download=function(){function a(a,c){var b=document.createElement("a");b.href=URL.createObjectURL(new Blob([a]),{type:"text/plain"});b.download=c.replace(/[^a-zA-Z\d+\.\-_\s]/g,"_");b.style.display="none";document.body.appendChild(b);b.click();document.body.removeChild(b)}function c(a,c){var b=document.createElement("div");var d=document.createElement("form");var g=document.createElement("textarea");var h=document.createElement("input");h.type="hidden";d.setAttribute("method","post");d.setAttribute("action",
"download/text");g.setAttribute("name","data");g.setAttribute("id","data");h.setAttribute("name","filename");h.setAttribute("id","filename");h.value=c.replace(/[^a-zA-Z\d+\.\-_\s]/g,"_");d.appendChild(g);d.appendChild(h);b.appendChild(d);document.body.appendChild(b);b.style.display="none";g.innerHTML=a;d.submit();document.body.removeChild(b)}return{json:function(b,d){null==d&&(d="wpd_plot_data.json");wpd.browserInfo.downloadAttributeSupported?a(b,d):c(b,d)},csv:function(b,d){null==d&&(d="data.csv");
wpd.browserInfo.downloadAttributeSupported?a(b,d):c(b,d)}}}();wpd=wpd||{};
wpd.log=function(){wpd.browserInfo.isElectronBrowser()||fetch("log").then(function(a){return a.text()}).then(function(a){"true"==a&&(a={},a["screen-size"]=window.screen.width+"x"+window.screen.height,a["document-location"]=document.location.href,a["document-referrer"]=document.referrer,a.platform=window.navigator.platform,a.userAgent=window.navigator.userAgent,a.language=window.navigator.language,fetch("log",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},
body:JSON.stringify(a)}))})};wpd=wpd||{};wpd.plotly=function(){return{send:function(a){var c=document.createElement("div"),b=document.createElement("form"),d=document.createElement("textarea");b.setAttribute("method","post");b.setAttribute("action","https://plot.ly/external");b.setAttribute("target","_blank");d.setAttribute("name","data");d.setAttribute("id","data");b.appendChild(d);c.appendChild(b);document.body.appendChild(c);c.style.display="none";a=JSON.stringify(a);d.innerHTML=a;b.submit();document.body.removeChild(c)}}}();
wpd=wpd||{};
wpd.saveResume=function(){function a(){var a=wpd.appData.getPlotData();return JSON.stringify(a.serialize())}function c(a){var b=new FileReader;b.onload=function(){var a=JSON.parse(b.result);wpd.appData.getPlotData().deserialize(a);wpd.tree.refresh();wpd.graphicsWidget.resetData();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.tree.refresh();wpd.messagePopup.show(wpd.gettext("import-json"),wpd.gettext("json-data-loaded"))};b.readAsText(a)}function b(a){wpd.busyNote.show();var b=
new tarball.TarReader;b.readFile(a).then(function(a){wpd.busyNote.close();var c=a.findIndex(function(a){return a.name.endsWith("/info.json")});if(0<=c){a=a[c].name.replace("/info.json","");c=b.getFileBlob(a+"/image.png","image/png");c.name="image.png";var d=JSON.parse(b.getTextFile(a+"/wpd.json"));wpd.imageManager.loadFromFile(c,!0).then(function(){wpd.appData.getPlotData().deserialize(d);wpd.tree.refresh();wpd.tree.refresh();wpd.messagePopup.show(wpd.gettext("import-json"),wpd.gettext("json-data-loaded"))})}},
function(a){console.log(a)})}return{save:function(){wpd.popup.show("export-json-window")},load:function(){wpd.popup.show("import-json-window")},downloadJSON:function(){var b=document.getElementById("project-name-input").value.replace(/[^a-zA-Z\d+\.\-_\s]/g,"_")+".json";wpd.download.json(a(),b);wpd.popup.close("export-json-window")},downloadProject:function(){var b=document.getElementById("project-name-input").value.replace(/[^a-zA-Z\d+\.\-_\s]/g,"_"),c=a(),f=wpd.graphicsWidget.getImagePNG(),g=JSON.stringify({version:[4,
0],json:"wpd.json",image:"image.png"}),h=new tarball.TarWriter;h.addFolder(b+"/");h.addTextFile(b+"/info.json",g);h.addTextFile(b+"/wpd.json",c);h.addFile(b+"/image.png",f);h.download(b+".tar");wpd.popup.close("export-json-window")},read:function(){var a=document.getElementById("import-json-file");wpd.popup.close("import-json-window");if(1===a.files.length){var a=a.files[0],e=a.type;if(""==e||null==e)a.name.endsWith(".json")?e="application/json":a.name.endsWith(".tar")&&(e="application/x-tar");"application/json"==
e?c(a):"application/x-tar"==e?b(a):wpd.messagePopup.show(wpd.gettext("invalid-project"),wpd.gettext("invalid-project-msg"))}}}}();wpd=wpd||{};
wpd.scriptInjector=function(){return{start:function(){wpd.popup.show("runScriptPopup")},cancel:function(){wpd.popup.close("runScriptPopup")},load:function(){var a=document.getElementById("runScriptFileInput");wpd.popup.close("runScriptPopup");if(1==a.files.length){var c=new FileReader;c.onload=function(){"undefined"!==typeof wpdscript&&(wpdscript=null);eval(c.result);"wpdscript"!==typeof wpdscript&&(window.wpdscript=wpdscript,wpdscript.run())};c.readAsText(a.files[0])}}}}();wpd=wpd||{};
wpd.appData=function(){function a(){null==b&&(b=new wpd.PlotData);return b}function c(){return 0<a().getAxesCount()}var b,d=null;return{isAligned:c,getPlotData:a,reset:function(){c=!1;d=b=null},plotLoaded:function(b){a().getAutoDetector().topColors=wpd.colorAnalyzer.getTopColors(b)},backupImageData:d}}();wpd=wpd||{};wpd.autoExtraction=function(){return{start:function(){wpd.colorPicker.init();wpd.algoManager.updateAlgoList()}}}();
wpd.algoManager=function(){function a(){var a=document.getElementById("auto-extract-algo-name").value,b=wpd.appData.getPlotData().getAutoDetector();b.algorithm="averagingWindow"===a?new wpd.AveragingWindowAlgo:"XStepWithInterpolation"===a?new wpd.XStepWithInterpolationAlgo:"XStep"===a?new wpd.AveragingWindowWithStepSizeAlgo:"blobDetector"===a?new wpd.BlobDetectorAlgo:"barExtraction"===a||"histogram"===a?new wpd.BarExtractionAlgo:new wpd.AveragingWindowAlgo;var b=b.algorithm,a=document.getElementById("algo-parameter-container"),
b=b.getParamList(c),f,g="<table>";for(f=0;f<b.length;f++)g+="<tr><td>"+b[f][0]+'</td><td><input type="text" size=3 id="algo-param-'+f+'" class="algo-params" value="'+b[f][2]+'"/></td><td>'+b[f][1]+"</td></tr>";a.innerHTML=g+"</table>"}var c,b;return{updateAlgoList:function(){b=wpd.tree.getActiveDataset();c=wpd.appData.getPlotData().getAxesForDataset(b);var d="",e=document.getElementById("auto-extract-algo-name");c instanceof wpd.BarAxes||(d+='<option value="averagingWindow">'+wpd.gettext("averaging-window")+
"</option>");c instanceof wpd.XYAxes&&(d+='<option value="XStepWithInterpolation">'+wpd.gettext("x-step-with-interpolation")+"</option>",d+='<option value="XStep">'+wpd.gettext("x-step")+"</option>");c instanceof wpd.BarAxes||(d+='<option value="blobDetector">'+wpd.gettext("blob-detector")+"</option>");c instanceof wpd.BarAxes&&(d+='<option value="barExtraction">'+wpd.gettext("bar-extraction")+"</option>");c instanceof wpd.XYAxes&&(d+='<option value="histogram">'+wpd.gettext("histogram")+"</option>");
e.innerHTML=d;a()},applyAlgoSelection:a,run:function(){wpd.busyNote.show();var a=wpd.appData.getPlotData().getAutoDetector(),e=a.algorithm,f=new wpd.DataPointsRepainter(c,b),g=document.getElementsByClassName("algo-params"),h,k=wpd.graphicsWidget.getAllContexts(),l=wpd.graphicsWidget.getImageSize();for(h=0;h<g.length;h++){var n=g[h].id;n=parseInt(n.replace("algo-param-",""),10);e.setParam(n,parseFloat(g[h].value))}wpd.graphicsWidget.removeTool();a.imageData=k.oriImageCtx.getImageData(0,0,l.width,l.height);
a.generateBinaryData();wpd.graphicsWidget.setRepainter(f);e.run(a,b,c);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount(b.getCount());wpd.busyNote.close();return!0}}}();
wpd.dataMask=function(){function a(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize(),a=a.oriDataCtx.getImageData(0,0,b.width,b.height),b=[],d,e=0,f=wpd.appData.getPlotData().getAutoDetector();for(d=0;d<a.data.length;d+=4)255===a.data[d]&&255===a.data[d+1]&&0===a.data[d+2]&&(b[e]=d/4,e++);f.mask=b}return{grabMask:a,markBox:function(){var a=new wpd.BoxMaskTool;wpd.graphicsWidget.setTool(a)},markPen:function(){var a=new wpd.PenMaskTool;wpd.graphicsWidget.setTool(a)},eraseMarks:function(){var a=
new wpd.EraseMaskTool;wpd.graphicsWidget.setTool(a)},viewMask:function(){var a=new wpd.ViewMaskTool;wpd.graphicsWidget.setTool(a)},clearMask:function(){wpd.graphicsWidget.resetData();a()}}}();wpd=wpd||{};wpd.AxesCalibrator=function(a,c){this._calibration=a;this._isEditing=c};wpd.XYAxesCalibrator=function(a){wpd.AxesCalibrator.apply(this,arguments)};$jscomp.inherits(wpd.XYAxesCalibrator,wpd.AxesCalibrator);wpd.XYAxesCalibrator.prototype.start=function(){wpd.popup.show("xyAxesInfo")};
wpd.XYAxesCalibrator.prototype.reload=function(){var a=new wpd.AxesCornersTool(this._calibration,!0);wpd.graphicsWidget.setTool(a)};wpd.XYAxesCalibrator.prototype.pickCorners=function(){wpd.popup.close("xyAxesInfo");var a=new wpd.AxesCornersTool(this._calibration,!1);wpd.graphicsWidget.setTool(a)};
wpd.XYAxesCalibrator.prototype.getCornerValues=function(){wpd.popup.show("xyAlignment");if(this._isEditing){var a=wpd.tree.getActiveAxes(),c=a.calibration;4==c.getCount()&&(document.getElementById("xmin").value=c.getPoint(0).dx,document.getElementById("xmax").value=c.getPoint(1).dx,document.getElementById("ymin").value=c.getPoint(2).dy,document.getElementById("ymax").value=c.getPoint(3).dy,document.getElementById("xlog").checked=a.isLogX(),document.getElementById("ylog").checked=a.isLogY())}};
wpd.XYAxesCalibrator.prototype.align=function(){var a=document.getElementById("xmin").value,c=document.getElementById("xmax").value,b=document.getElementById("ymin").value,d=document.getElementById("ymax").value,e=document.getElementById("xlog").checked,f=document.getElementById("ylog").checked,g=this._isEditing?wpd.tree.getActiveAxes():new wpd.XYAxes;if(e&&(0==parseFloat(a)||0==parseFloat(c))||f&&(0==parseFloat(b)||0==parseFloat(d)))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-log-inputs"),
wpd.gettext("calibration-enter-valid-log"),wpd.alignAxes.getCornerValues),!1;this._calibration.setDataAt(0,a,b);this._calibration.setDataAt(1,c,b);this._calibration.setDataAt(2,a,b);this._calibration.setDataAt(3,c,d);if(!g.calibrate(this._calibration,e,f))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-inputs"),wpd.gettext("calibration-enter-valid"),wpd.alignAxes.getCornerValues),!1;this._isEditing||(g.name=wpd.alignAxes.makeAxesName(wpd.XYAxes),wpd.appData.getPlotData().addAxes(g));
wpd.popup.close("xyAlignment");return!0};wpd.BarAxesCalibrator=function(a){wpd.AxesCalibrator.apply(this,arguments)};$jscomp.inherits(wpd.BarAxesCalibrator,wpd.AxesCalibrator);wpd.BarAxesCalibrator.prototype.start=function(){wpd.popup.show("barAxesInfo")};wpd.BarAxesCalibrator.prototype.reload=function(){var a=new wpd.AxesCornersTool(this._calibration,!0);wpd.graphicsWidget.setTool(a)};
wpd.BarAxesCalibrator.prototype.pickCorners=function(){wpd.popup.close("barAxesInfo");var a=new wpd.AxesCornersTool(this._calibration,!1);wpd.graphicsWidget.setTool(a)};
wpd.BarAxesCalibrator.prototype.getCornerValues=function(){wpd.popup.show("barAlignment");if(this._isEditing){var a=wpd.tree.getActiveAxes(),c=a.calibration;2==c.getCount()&&(document.getElementById("bar-axes-p1").value=c.getPoint(0).dy,document.getElementById("bar-axes-p2").value=c.getPoint(1).dy,document.getElementById("bar-axes-log-scale").checked=a.isLog(),document.getElementById("bar-axes-rotated").checked=a.isRotated())}};
wpd.BarAxesCalibrator.prototype.align=function(){var a=document.getElementById("bar-axes-p1").value,c=document.getElementById("bar-axes-p2").value,b=document.getElementById("bar-axes-log-scale").checked,d=document.getElementById("bar-axes-rotated").checked,e=this._isEditing?wpd.tree.getActiveAxes():new wpd.BarAxes;this._calibration.setDataAt(0,0,a);this._calibration.setDataAt(1,0,c);if(!e.calibrate(this._calibration,b,d))return wpd.popup.close("barAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-inputs"),
wpd.gettext("calibration-enter-valid"),wpd.alignAxes.getCornerValues),!1;this._isEditing||(e.name=wpd.alignAxes.makeAxesName(wpd.BarAxes),wpd.appData.getPlotData().addAxes(e));wpd.popup.close("barAlignment");return!0};wpd.PolarAxesCalibrator=function(a){wpd.AxesCalibrator.apply(this,arguments)};$jscomp.inherits(wpd.PolarAxesCalibrator,wpd.AxesCalibrator);wpd.PolarAxesCalibrator.prototype.start=function(){wpd.popup.show("polarAxesInfo")};
wpd.PolarAxesCalibrator.prototype.reload=function(){var a=new wpd.AxesCornersTool(this._calibration,!0);wpd.graphicsWidget.setTool(a)};wpd.PolarAxesCalibrator.prototype.pickCorners=function(){wpd.popup.close("polarAxesInfo");var a=new wpd.AxesCornersTool(this._calibration,!1);wpd.graphicsWidget.setTool(a)};
wpd.PolarAxesCalibrator.prototype.getCornerValues=function(){wpd.popup.show("polarAlignment");if(this._isEditing){var a=wpd.tree.getActiveAxes(),c=a.calibration;3==c.getCount()&&(document.getElementById("polar-r1").value=c.getPoint(1).dx,document.getElementById("polar-theta1").value=c.getPoint(1).dy,document.getElementById("polar-r2").value=c.getPoint(2).dx,document.getElementById("polar-theta2").value=c.getPoint(2).dy,document.getElementById("polar-degrees").checked=a.isThetaDegrees(),document.getElementById("polar-radians").checked=
!a.isThetaDegrees(),document.getElementById("polar-clockwise").checked=a.isThetaClockwise(),document.getElementById("polar-log-scale").checked=a.isRadialLog())}};
wpd.PolarAxesCalibrator.prototype.align=function(){var a=parseFloat(document.getElementById("polar-r1").value),c=parseFloat(document.getElementById("polar-theta1").value),b=parseFloat(document.getElementById("polar-r2").value),d=parseFloat(document.getElementById("polar-theta2").value),e=document.getElementById("polar-degrees").checked,f=document.getElementById("polar-clockwise").checked,g=document.getElementById("polar-log-scale").checked,h=this._isEditing?wpd.tree.getActiveAxes():new wpd.PolarAxes;
this._calibration.setDataAt(1,a,c);this._calibration.setDataAt(2,b,d);h.calibrate(this._calibration,e,f,g);this._isEditing||(h.name=wpd.alignAxes.makeAxesName(wpd.PolarAxes),wpd.appData.getPlotData().addAxes(h));wpd.popup.close("polarAlignment");return!0};wpd.TernaryAxesCalibrator=function(a){wpd.AxesCalibrator.apply(this,arguments)};$jscomp.inherits(wpd.TernaryAxesCalibrator,wpd.AxesCalibrator);wpd.TernaryAxesCalibrator.prototype.start=function(){wpd.popup.show("ternaryAxesInfo")};
wpd.TernaryAxesCalibrator.prototype.reload=function(){var a=new wpd.AxesCornersTool(this._calibration,!0);wpd.graphicsWidget.setTool(a)};wpd.TernaryAxesCalibrator.prototype.pickCorners=function(){wpd.popup.close("ternaryAxesInfo");var a=new wpd.AxesCornersTool(this._calibration,!1);wpd.graphicsWidget.setTool(a)};
wpd.TernaryAxesCalibrator.prototype.getCornerValues=function(){wpd.popup.show("ternaryAlignment");if(this._isEditing){var a=wpd.tree.getActiveAxes();3==prevCal.getCount()&&(document.getElementById("range0to1").checked=!a.isRange100(),document.getElementById("range0to100").checked=a.isRange100(),document.getElementById("ternarynormal").checked=a.isNormalOrientation())}};
wpd.TernaryAxesCalibrator.prototype.align=function(){var a=document.getElementById("range0to100").checked,c=document.getElementById("ternarynormal").checked,b=this._isEditing?wpd.tree.getActiveAxes():new wpd.TernaryAxes;b.calibrate(this._calibration,a,c);this._isEditing||(b.name=wpd.alignAxes.makeAxesName(wpd.TernaryAxes),wpd.appData.getPlotData().addAxes(b));wpd.popup.close("ternaryAlignment");return!0};wpd.MapAxesCalibrator=function(a){wpd.AxesCalibrator.apply(this,arguments)};
$jscomp.inherits(wpd.MapAxesCalibrator,wpd.AxesCalibrator);wpd.MapAxesCalibrator.prototype.start=function(){wpd.popup.show("mapAxesInfo")};wpd.MapAxesCalibrator.prototype.reload=function(){var a=new wpd.AxesCornersTool(this._calibration,!0);wpd.graphicsWidget.setTool(a)};wpd.MapAxesCalibrator.prototype.pickCorners=function(){wpd.popup.close("mapAxesInfo");var a=new wpd.AxesCornersTool(this._calibration,!1);wpd.graphicsWidget.setTool(a)};
wpd.MapAxesCalibrator.prototype.getCornerValues=function(){wpd.popup.show("mapAlignment");if(this._isEditing){var a=wpd.tree.getActiveAxes();2==prevCal.getCount()&&(document.getElementById("scaleLength").checked=a.getScaleLength(),document.getElementById("scaleUnits").checked=a.getUnits())}};
wpd.MapAxesCalibrator.prototype.align=function(){var a=parseFloat(document.getElementById("scaleLength").value),c=document.getElementById("scaleUnits").value,b=this._isEditing?wpd.tree.getActiveAxes():new wpd.MapAxes;b.calibrate(this._calibration,a,c);this._isEditing||(b.name=wpd.alignAxes.makeAxesName(wpd.MapAxes),wpd.appData.getPlotData().addAxes(b));wpd.popup.close("mapAlignment");return!0};
wpd.alignAxes=function(){function a(){var a=wpd.tree.getActiveAxes();document.getElementById("rename-axes-name-input").value=a.name;wpd.popup.show("rename-axes-popup")}function c(){var b=document.getElementById("rename-axes-name-input");wpd.popup.close("rename-axes-popup");b=b.value.trim();0<=wpd.appData.getPlotData().getAxesNames().indexOf(b)||0===b.length?wpd.messagePopup.show(wpd.gettext("rename-axes-error"),wpd.gettext("axes-exists-error"),a):(wpd.tree.getActiveAxes().name=b,wpd.tree.refresh(),
wpd.tree.selectPath("/"+wpd.gettext("axes")+"/"+b,!0))}var b,d;return{start:function(){xyEl=document.getElementById("r_xy");polarEl=document.getElementById("r_polar");ternaryEl=document.getElementById("r_ternary");mapEl=document.getElementById("r_map");imageEl=document.getElementById("r_image");barEl=document.getElementById("r_bar");wpd.popup.close("axesList");if(!0===xyEl.checked)b=new wpd.Calibration(2),b.labels=["X1","X2","Y1","Y2"],b.labelPositions=["N","N","E","E"],b.maxPointCount=4,d=new wpd.XYAxesCalibrator(b);
else if(!0===barEl.checked)b=new wpd.Calibration(2),b.labels=["P1","P2"],b.labelPositions=["S","S"],b.maxPointCount=2,d=new wpd.BarAxesCalibrator(b);else if(!0===polarEl.checked)b=new wpd.Calibration(2),b.labels=["Origin","P1","P2"],b.labelPositions=["E","S","S"],b.maxPointCount=3,d=new wpd.PolarAxesCalibrator(b);else if(!0===ternaryEl.checked)b=new wpd.Calibration(2),b.labels=["A","B","C"],b.labelPositions=["S","S","E"],b.maxPointCount=3,d=new wpd.TernaryAxesCalibrator(b);else if(!0===mapEl.checked)b=
new wpd.Calibration(2),b.labels=["P1","P2"],b.labelPositions=["S","S"],b.maxPointCount=2,d=new wpd.MapAxesCalibrator(b);else if(!0===imageEl.checked){d=b=null;var a=new wpd.ImageAxes;a.name=wpd.alignAxes.makeAxesName(wpd.ImageAxes);a.calibrate();wpd.appData.getPlotData().addAxes(a);wpd.tree.refresh();a=wpd.appData.getPlotData().getDatasetNames();0<a.length&&(a=a[0],wpd.tree.selectPath("/"+wpd.gettext("datasets")+"/"+a,!0));wpd.acquireData.load()}null!=d&&(d.start(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter(b)))},
calibrationCompleted:function(){wpd.sidebar.show("axes-calibration-sidebar")},zoomCalPoint:function(a){a=b.getPoint(a);wpd.graphicsWidget.updateZoomToImagePosn(a.px,a.py)},getCornerValues:function(){d.getCornerValues()},pickCorners:function(){d.pickCorners()},align:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();if(d.align()){wpd.tree.refresh();var a=wpd.appData.getPlotData().getDatasetNames();0<a.length&&(a=a[0],wpd.tree.selectPath("/"+
wpd.gettext("datasets")+"/"+a))}},editAlignment:function(){wpd.appData.isAligned()&&null!=d?wpd.popup.show("edit-or-reset-calibration-popup"):wpd.popup.show("axesList")},reloadCalibrationForEditing:function(){wpd.popup.close("edit-or-reset-calibration-popup");d=null;var a=wpd.tree.getActiveAxes();b=a.calibration;a instanceof wpd.XYAxes?d=new wpd.XYAxesCalibrator(b,!0):a instanceof wpd.BarAxes?d=new wpd.BarAxesCalibrator(b,!0):a instanceof wpd.PolarAxes?d=new wpd.PolarAxesCalibrator(b,!0):a instanceof
wpd.TernaryAxes?d=new wpd.TernaryAxesCalibrator(b,!0):a instanceof wpd.MapAxes&&(d=new wpd.MapAxesCalibrator(b,!0));null!=d&&(d.reload(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter(b)),wpd.graphicsWidget.forceHandlerRepaint(),wpd.sidebar.show("axes-calibration-sidebar"))},addCalibration:function(){wpd.popup.show("axesList")},deleteCalibration:function(){wpd.okCancelPopup.show(wpd.gettext("delete-axes"),wpd.gettext("delete-axes-text"),function(){var a=wpd.appData.getPlotData(),
b=wpd.tree.getActiveAxes();a.deleteAxes(b);wpd.tree.refresh();wpd.tree.selectPath("/"+wpd.gettext("axes"))})},showRenameAxes:a,makeAxesName:function(a){var b="",c=wpd.appData.getPlotData().getAxesNames();a===wpd.XYAxes?b=wpd.gettext("axes-name-xy"):a===wpd.PolarAxes?b=wpd.gettext("axes-name-polar"):a===wpd.MapAxes?b=wpd.gettext("axes-name-map"):a===wpd.TernaryAxes?b=wpd.gettext("axes-name-ternary"):a===wpd.BarAxes?b=wpd.gettext("axes-name-bar"):a===wpd.ImageAxes&&(b=wpd.gettext("axes-name-image"));
a=2;for(var d=b;0<=c.indexOf(d);)d=b+" "+a,a++;return d},renameAxes:c,renameKeypress:function(a){"Enter"===a.key&&c()}}}();wpd=wpd||{};
wpd.browserInfo=function(){return{checkBrowser:function(){window.FileReader||alert("\tWARNING!\nYour web browser is not supported. This program might not behave as intended. Please use a recent version of Google Chrome, Firefox or Safari browser.")},downloadAttributeSupported:"download"in document.createElement("a"),isElectronBrowser:function(){return"undefined"===typeof process?!1:!0}}}();wpd=wpd||{};
wpd.colorSelectionWidget=function(){function a(){document.getElementById("color-selection-selected-color-box").style.backgroundColor="rgb("+c[0]+","+c[1]+","+c[2]+")";document.getElementById("color-selection-red").value=c[0];document.getElementById("color-selection-green").value=c[1];document.getElementById("color-selection-blue").value=c[2];var a=document.getElementById("color-selection-options"),b=wpd.appData.getPlotData().getAutoDetector().topColors,d=10<b.length?10:b.length,e,l="";for(e=0;e<d;e++){var n=
"rgb("+b[e].r+","+b[e].g+","+b[e].b+");";var m=b[e].percentage.toFixed(3)+"%";l+='<div class="colorOptionBox" style="background-color: '+n+'" title="'+m+'" onclick="wpd.colorSelectionWidget.selectTopColor('+e+');"></div>'}a.innerHTML=l;wpd.popup.show("color-selection-widget")}var c,b,d,e;return{setParams:function(a){c=a.color;b=a.triggerElementId;d=a.title;e=a.setColorDelegate;document.getElementById("color-selection-title").innerHTML=d},startPicker:a,pickColor:function(){wpd.popup.close("color-selection-widget");
var b=new wpd.ColorPickerTool;b.onComplete=function(b){c=b;e(b);wpd.graphicsWidget.removeTool();a()};wpd.graphicsWidget.setTool(b)},setColor:function(){var a=[];a[0]=parseInt(document.getElementById("color-selection-red").value,10);a[1]=parseInt(document.getElementById("color-selection-green").value,10);a[2]=parseInt(document.getElementById("color-selection-blue").value,10);c=a;e(a);wpd.popup.close("color-selection-widget");a=document.getElementById(b);a.style.backgroundColor="rgb("+c[0]+","+c[1]+
","+c[2]+")";a.style.color=200>c[0]+c[1]+c[2]?"rgb(255,255,255)":"rgb(0,0,0)"},selectTopColor:function(b){var d=[],f=wpd.appData.getPlotData().getAutoDetector().topColors;d[0]=f[b].r;d[1]=f[b].g;d[2]=f[b].b;c=d;e(d);a()},paintFilteredColor:function(a,b){var c=wpd.graphicsWidget.getAllContexts();wpd.appData.getPlotData().getAutoDetector();var d=wpd.graphicsWidget.getImageSize(),e;var f=c.oriDataCtx.getImageData(0,0,d.width,d.height);if(null!=b&&0!==b.length){for(e=0;e<b.length;e++){var g=b[e];!0===
a[g]?(parseInt(g/d.width,10),f.data[4*g]=255,f.data[4*g+1]=255,f.data[4*g+2]=0,f.data[4*g+3]=255):(f.data[4*g]=0,f.data[4*g+1]=0,f.data[4*g+2]=0,f.data[4*g+3]=150)}c.oriDataCtx.putImageData(f,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}}}}();
wpd.colorPicker=function(){function a(){return{color:wpd.appData.getPlotData().getAutoDetector().fgColor,triggerElementId:"color-button",title:wpd.gettext("specify-foreground-color"),setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().fgColor=a}}}function c(){return{color:wpd.appData.getPlotData().getAutoDetector().bgColor,triggerElementId:"color-button",title:wpd.gettext("specify-background-color"),setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().bgColor=
a}}}function b(){var a=document.getElementById("color-button"),b=document.getElementById("color-distance-value"),c=wpd.appData.getPlotData().getAutoDetector(),g=document.getElementById("color-detection-mode-select");var h="fg"===c.colorDetectionMode?c.fgColor:c.bgColor;color_distance=c.colorDistance;a.style.backgroundColor="rgb("+h[0]+","+h[1]+","+h[2]+")";b.value=color_distance;g.value=c.colorDetectionMode}return{startPicker:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();
wpd.graphicsWidget.resetData();"fg"===wpd.appData.getPlotData().getAutoDetector().colorDetectionMode?wpd.colorSelectionWidget.setParams(a()):wpd.colorSelectionWidget.setParams(c());wpd.colorSelectionWidget.startPicker()},changeDetectionMode:function(){var a=document.getElementById("color-detection-mode-select");wpd.appData.getPlotData().getAutoDetector().colorDetectionMode=a.value;b()},changeColorDistance:function(){var a=parseFloat(document.getElementById("color-distance-value").value);wpd.appData.getPlotData().getAutoDetector().colorDistance=
a},init:b,testColorDetection:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.ColorFilterRepainter);var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),c=wpd.graphicsWidget.getImageSize();b.imageData=a.oriImageCtx.getImageData(0,0,c.width,c.height);b.generateBinaryData();wpd.colorSelectionWidget.paintFilteredColor(b.binaryData,b.mask)}}}();wpd=wpd||{};
wpd.dataSeriesManagement=function(){function a(a){return 0<=wpd.appData.getPlotData().getDatasetNames().indexOf(a)?!0:!1}function c(){var a=wpd.tree.getActiveDataset();document.getElementById("rename-dataset-name-input").value=a.name;wpd.popup.show("rename-dataset-popup")}function b(){var b=document.getElementById("rename-dataset-name-input");wpd.popup.close("rename-dataset-popup");if(a(b.value.trim()))wpd.messagePopup.show(wpd.gettext("rename-dataset-error"),wpd.gettext("dataset-exists-error"),c);
else{var e=wpd.tree.getActiveDataset();e.name=b.value.trim();wpd.tree.refresh();wpd.tree.selectPath("/"+wpd.gettext("datasets")+"/"+e.name,!0)}}return{showAddDataset:function(){for(var b=document.getElementById("add-single-dataset-name-input"),c=wpd.appData.getPlotData().getDatasetCount(),f=wpd.gettext("dataset")+" "+c;a(f);)c++,f=wpd.gettext("dataset")+" "+c;b.value=f;wpd.popup.show("add-dataset-popup")},showRenameDataset:c,renameDataset:b,renameKeypress:function(a){"Enter"===a.key&&b()},addSingleDataset:function(){var b=
document.getElementById("add-single-dataset-name-input");wpd.popup.close("add-dataset-popup");if(a(b.value.trim()))wpd.messagePopup.show(wpd.gettext("add-dataset-error"),wpd.gettext("dataset-exists-error"),function(){wpd.popup.show("add-dataset-popup")});else{var c=wpd.appData.getPlotData(),f=new wpd.Dataset;f.name=b.value.trim();c.addDataset(f);wpd.tree.refreshPreservingSelection()}},addMultipleDatasets:function(){var b=document.getElementById("add-multiple-datasets-count-input"),b=parseInt(b.value,
0);wpd.popup.close("add-dataset-popup");if(0<b){for(var c=wpd.appData.getPlotData(),f=wpd.appData.getPlotData().getDatasetCount(),g=wpd.gettext("dataset")+" ",h=0;h<b;){var k=g+f;if(!a(k)){var l=new wpd.Dataset;l.name=k;c.addDataset(l);h++}f++}wpd.tree.refreshPreservingSelection()}else wpd.messagePopup(wpd.gettext("add-dataset-error"),wpd.gettext("add-dataset-count-error"),function(){wpd.popup.show("add-dataset-popup")})},deleteDataset:function(){wpd.okCancelPopup.show(wpd.gettext("delete-dataset"),
wpd.gettext("delete-dataset-text"),function(){var a=wpd.appData.getPlotData(),b=wpd.tree.getActiveDataset();a.deleteDataset(b);wpd.tree.refresh();wpd.tree.selectPath("/"+wpd.gettext("datasets"))})},changeAxes:function(a){var b=wpd.appData.getPlotData(),c=b.getAxesColl(),d=wpd.tree.getActiveDataset();a=parseInt(a,10);-1===a?b.setAxesForDataset(d,null):0<=a&&a<c.length&&b.setAxesForDataset(d,c[a]);wpd.tree.refreshPreservingSelection(!0)}}}();wpd=wpd||{};
wpd.gridDetection=function(){function a(a,b,c){var d=wpd.appData.getPlotData().getAutoDetector().backupImageData,e;for(e=0;e<d.data.length;e++)a.data[e]=d.data[e];return{imageData:a,width:b,height:c,keepZoom:!0}}function c(){wpd.graphicsWidget.removeTool();wpd.appData.getPlotData().getAutoDetector().gridData=null;wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();null!=wpd.appData.getPlotData().getAutoDetector().backupImageData&&wpd.graphicsWidget.runImageOp(a)}function b(a,b,c){var d=
wpd.appData.getPlotData().getAutoDetector().gridData,e=wpd.appData.getPlotData().getAutoDetector().topColors[0],f,g;null==e&&(e={r:255,g:0,b:0});if(null!=d)for(f=0;f<c;f++)for(g=0;g<b;g++){var m=4*(f*b+g);!0===d[m/4]&&(a.data[m]=e.r,a.data[m+1]=e.g,a.data[m+2]=e.b,a.data[m+3]=255)}return{imageData:a,width:b,height:c}}function d(){var a=parseFloat(document.getElementById("grid-color-distance").value);wpd.appData.getPlotData().getAutoDetector().gridColorDistance=a}return{start:function(){wpd.graphicsWidget.removeTool();
wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();wpd.sidebar.show("grid-detection-sidebar");var a=document.getElementById("grid-color-picker-button"),b=document.getElementById("grid-background-mode"),c=wpd.appData.getPlotData().getAutoDetector(),d=c.gridLineColor,c=c.gridBackgroundMode;null!=d&&(a.style.backgroundColor="rgb("+d[0]+","+d[1]+","+d[2]+")",a.style.color=200>d[0]+d[1]+d[2]?"rgb(255,255,255)":"rgb(0,0,0)");b.checked=c;a=wpd.appData.getPlotData().getAutoDetector();b=wpd.graphicsWidget.getAllContexts();
d=wpd.graphicsWidget.getImageSize();a.imageData=b.oriImageCtx.getImageData(0,0,d.width,d.height)},markBox:function(){var a=new wpd.GridBoxTool;wpd.graphicsWidget.setTool(a)},clearMask:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.getPlotData().getAutoDetector().gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};wpd.graphicsWidget.resetData()},viewMask:function(){var a=new wpd.GridViewMaskTool;wpd.graphicsWidget.setTool(a)},grabMask:function(){var a=
wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize(),a=a.oriDataCtx.getImageData(0,0,b.width,b.height),c=[],d,k=0,l=wpd.appData.getPlotData().getAutoDetector();for(d=0;d<a.data.length;d+=4)if(255===a.data[d]&&255===a.data[d+1]&&0===a.data[d+2]){c[k]=d/4;k++;var n=parseInt(d/4%b.width,10);var m=parseInt(d/4/b.width,10);1===k?(l.gridMask.xmin=n,l.gridMask.xmax=n,l.gridMask.ymin=m,l.gridMask.ymax=m):(n<l.gridMask.xmin&&(l.gridMask.xmin=n),n>l.gridMask.xmax&&(l.gridMask.xmax=n),m<l.gridMask.ymin&&
(l.gridMask.ymin=m),m>l.gridMask.ymax&&(l.gridMask.ymax=m))}l.gridMask.pixels=c},startColorPicker:function(){wpd.colorSelectionWidget.setParams({color:wpd.appData.getPlotData().getAutoDetector().gridLineColor,triggerElementId:"grid-color-picker-button",title:"Specify Grid Line Color",setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().gridLineColor=a}});wpd.colorSelectionWidget.startPicker()},changeColorDistance:d,changeBackgroundMode:function(){var a=document.getElementById("grid-background-mode").checked;
wpd.appData.getPlotData().getAutoDetector().gridBackgroundMode=a},testColor:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.GridColorFilterRepainter);var a=wpd.appData.getPlotData().getAutoDetector();d();a.generateGridBinaryData();wpd.colorSelectionWidget.paintFilteredColor(a.gridBinaryData,a.gridMask.pixels)},run:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();c();var a=
wpd.appData.getPlotData().getAutoDetector(),d=wpd.graphicsWidget.getAllContexts(),g=wpd.graphicsWidget.getImageSize(),h=document.getElementById("grid-horiz-perc"),k=document.getElementById("grid-vert-perc"),l=document.getElementById("grid-horiz-enable").checked,n=document.getElementById("grid-vert-enable").checked;document.getElementById("grid-background-mode");wpd.appData.getPlotData();null==a.backupImageData&&(a.backupImageData=d.oriImageCtx.getImageData(0,0,g.width,g.height));a.imageData=d.oriImageCtx.getImageData(0,
0,g.width,g.height);a.generateGridBinaryData();wpd.gridDetectionCore.setHorizontalParameters(l,h.value);wpd.gridDetectionCore.setVerticalParameters(n,k.value);wpd.appData.getPlotData().getAutoDetector().gridData=wpd.gridDetectionCore.run(a);wpd.graphicsWidget.runImageOp(b);wpd.appData.getPlotData().getAutoDetector().gridData=null},reset:c}}();wpd=wpd||{};wpd.gettext=function(a){return(a=document.getElementById("i18n-string-"+a))?a.innerHTML:"i18n string"};wpd=wpd||{};
wpd.imageManager=function(){function a(a,b){return new Promise(function(d,e){if(a.type.match("image.*")){wpd.busyNote.show();var f=new FileReader;f.onload=function(){c(f.result,b).then(d)};f.readAsDataURL(a)}else if("application/pdf"==a.type){wpd.busyNote.show();var g=new FileReader;g.onload=function(){PDFJS.getDocument(g.result).then(function(a){a.getPage(1).then(function(a){var f=a.getViewport(3),g=document.createElement("canvas"),h=g.getContext("2d");g.width=f.width;g.height=f.height;a.render({canvasContext:h,
viewport:f}).promise.then(function(){var a=g.toDataURL();c(a,b).then(d)},function(a){console.log(a);wpd.busyNote.close();e(a)})})})};g.readAsDataURL(a)}else console.log(a.type),wpd.messagePopup.show(wpd.gettext("invalid-file"),wpd.gettext("invalid-file-text"))})}function c(a,c){return new Promise(function(d,e){var f=new Image;f.onload=function(){wpd.appData.reset();wpd.sidebar.clear();var a=wpd.graphicsWidget.loadImage(f);wpd.appData.plotLoaded(a);wpd.busyNote.close();wpd.tree.refresh();b?wpd.sidebar.show("start-sidebar"):
c||wpd.popup.show("axesList");b=!1;d()};f.src=a})}var b=!0;return{saveImage:function(){wpd.graphicsWidget.saveImage()},loadFromURL:c,loadFromFile:a,load:function(){var b=document.getElementById("fileLoadBox");1==b.files.length&&a(b.files[0]);wpd.popup.close("loadNewImage")}}}();wpd=wpd||{};
wpd.acquireData=function(){function a(){var a=new wpd.ManualSelectionTool(h,g);wpd.graphicsWidget.setTool(a)}function c(){var a=new wpd.DeleteDataPointTool(h,g);wpd.graphicsWidget.setTool(a)}function b(){g.clearAll();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.dataPointCounter.setCount(g.getCount());wpd.graphicsWidget.removeRepainter()}function d(){wpd.sidebar.show("acquireDataSidebar");document.getElementById("edit-data-labels").style.display=h instanceof wpd.BarAxes?"inline-block":
"none";wpd.dataPointCounter.setCount(g.getCount())}function e(){wpd.graphicsWidget.setTool(new wpd.AdjustDataPointTool(h,g))}function f(){wpd.graphicsWidget.setTool(new wpd.EditLabelsTool(h,g))}var g,h;return{load:function(){g=wpd.tree.getActiveDataset();h=wpd.appData.getPlotData().getAxesForDataset(wpd.tree.getActiveDataset());null==h?wpd.messagePopup.show(wpd.gettext("dataset-no-calibration"),wpd.gettext("calibrate-dataset")):(wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.resetData(),d(),wpd.autoExtraction.start(),
wpd.dataPointCounter.setCount(),wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter(h,g)),a(),wpd.graphicsWidget.forceHandlerRepaint(),wpd.dataPointCounter.setCount(g.getCount()))},manualSelection:a,adjustPoints:e,deletePoint:c,clearAll:function(){0>=g.getCount()||wpd.okCancelPopup.show(wpd.gettext("clear-data-points"),wpd.gettext("clear-data-points-text"),b,function(){})},undo:function(){g.removeLastPixel();wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();
wpd.dataPointCounter.setCount(g.getCount())},showSidebar:d,switchToolOnKeyPress:function(b){switch(b){case "d":c();break;case "a":a();break;case "s":e();break;case "e":f()}},isToolSwitchKey:function(a){return wpd.keyCodes.isAlphabet(a,"a")||wpd.keyCodes.isAlphabet(a,"s")||wpd.keyCodes.isAlphabet(a,"d")||wpd.keyCodes.isAlphabet(a,"e")?!0:!1},editLabels:f}}();
wpd.dataPointLabelEditor=function(){function a(){var a=document.getElementById("data-point-label-field").value;null!=a&&0<a.length&&(b.setMetadataAt(d,[a]),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint());wpd.popup.close("data-point-label-editor");wpd.graphicsWidget.setTool(e)}function c(){wpd.popup.close("data-point-label-editor");wpd.graphicsWidget.setTool(e)}var b,d,e;return{show:function(a,c,h){var f=a.getPixel(c).metadata[0];b=a;d=c;e=h;wpd.graphicsWidget.removeTool();
wpd.popup.show("data-point-label-editor");a=document.getElementById("data-point-label-field");a.value=f;a.focus()},ok:a,cancel:c,keydown:function(b){wpd.keyCodes.isEnter(b.keyCode)?a():wpd.keyCodes.isEsc(b.keyCode)&&c();b.stopPropagation()}}}();wpd=wpd||{};
wpd.measurementModes={distance:{name:"distance",connectivity:2,addButtonId:"add-pair-button",deleteButtonId:"delete-pair-button",sidebarId:"measure-distances-sidebar",init:function(){var a=wpd.appData.getPlotData();0==a.getMeasurementsByType(wpd.DistanceMeasurement).length&&a.addMeasurement(new wpd.DistanceMeasurement)},clear:function(){wpd.appData.getPlotData().getMeasurementsByType(wpd.DistanceMeasurement).forEach(function(a){a.clearAll()})},getData:function(){return wpd.appData.getPlotData().getMeasurementsByType(wpd.DistanceMeasurement)[0]},
getAxes:function(){var a=wpd.appData.getPlotData(),c=a.getMeasurementsByType(wpd.DistanceMeasurement);return a.getAxesForMeasurement(c[0])},changeAxes:function(a){var c=wpd.appData.getPlotData(),b=c.getMeasurementsByType(wpd.DistanceMeasurement)[0],d=c.getAxesColl();-1==a?c.setAxesForMeasurement(b,null):c.setAxesForMeasurement(b,d[a]);wpd.tree.refreshPreservingSelection(!0)}},angle:{name:"angle",connectivity:3,addButtonId:"add-angle-button",deleteButtonId:"delete-angle-button",sidebarId:"measure-angles-sidebar",
init:function(){var a=wpd.appData.getPlotData();0==a.getMeasurementsByType(wpd.AngleMeasurement).length&&a.addMeasurement(new wpd.AngleMeasurement)},clear:function(){wpd.appData.getPlotData().getMeasurementsByType(wpd.AngleMeasurement).forEach(function(a){a.clearAll()})},getData:function(){return wpd.appData.getPlotData().getMeasurementsByType(wpd.AngleMeasurement)[0]}},area:{name:"area",connectivity:-1,addButtonId:"add-polygon-button",deleteButtonId:"delete-polygon-button",sidebarId:"measure-area-sidebar",
init:function(){var a=wpd.appData.getPlotData();0==a.getMeasurementsByType(wpd.AreaMeasurement).length&&a.addMeasurement(new wpd.AreaMeasurement)},clear:function(){wpd.appData.getPlotData().getMeasurementsByType(wpd.AreaMeasurement).forEach(function(a){a.clearAll()})},getData:function(){return wpd.appData.getPlotData().getMeasurementsByType(wpd.AreaMeasurement)[0]},getAxes:function(){var a=wpd.appData.getPlotData(),c=a.getMeasurementsByType(wpd.AreaMeasurement);return a.getAxesForMeasurement(c[0])},
changeAxes:function(a){var c=wpd.appData.getPlotData(),b=c.getMeasurementsByType(wpd.AreaMeasurement)[0],d=c.getAxesColl();-1==a?c.setAxesForMeasurement(b,null):c.setAxesForMeasurement(b,d[a]);wpd.tree.refreshPreservingSelection(!0)}}};
wpd.measurement=function(){var a;return{start:function(c){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();c.init();wpd.sidebar.show(c.sidebarId);wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c));wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c));wpd.graphicsWidget.forceHandlerRepaint();a=c},addItem:function(){wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(a));wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(a))},deleteItem:function(){wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(a));
wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(a))},clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();a.clear()},changeAxes:function(c){a.changeAxes(parseInt(c,10))}}}();
